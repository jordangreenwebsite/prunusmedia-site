import{j as e,u as a}from"./fields-GHpMjljq.js";import{a as g,R as v}from"./vendor-BmsXziqF.js";import{P as i,I as N,B as k,s as R}from"./index-N_DirKM7.js";import{M as S}from"./Layout-6tbtb2_L.js";import{E as C}from"./index-CoDmPiQC.js";import{g as O}from"./index.esm-Cy9FKwRd.js";import"./Select-DTKZAkjT.js";import{I as P}from"./InputHidden-CbKoMq6o.js";const b=({icon:c,isSelected:r,callback:d})=>e.jsx("div",{title:c,className:`icon ${r?"selected":""}`,onClick:()=>{d(c)},children:e.jsx(N,{icon:c,width:"24px"})});b.propTypes={icon:i.string.isRequired,isSelected:i.bool,callback:i.func};const y=({type:c,defaultIcon:r=null,callback:d})=>{const[l,f]=g.useState([]),u="https://api.iconify.design/",j=s=>{fetch(`${u}search?query=${s}&prefix=dashicons&limit=96`).then(t=>t.json()).then(t=>{f(t.icons)})},h=()=>{fetch(`${u}collection?prefix=dashicons`).then(s=>s.json()).then(s=>{let t=[];s.uncategorized.map(o=>{t.push(`dashicons-${o}`)}),f(t)})},p=()=>{if(!wp||!wp.media){alert(a("The media gallery is not available. You must admin_enqueue this function: wp_enqueue_media()"));return}const s=wp.media({title:a("Upload an Image"),library:{type:["image"]},multiple:!1});s.on("select",function(t){const n=s.state().get("selection").first().toJSON().url;d(n)}),s.open()};return g.useEffect(()=>{h()},[]),c==="image"?e.jsxs(v.Fragment,{children:[r&&e.jsx("div",{className:"fit-content mt-8 mb-8 p-8 with-border b-rounded",children:e.jsx("img",{src:r,alt:"",width:128})}),e.jsx("a",{href:"#",className:"mt-1 acpt-btn acpt-btn-primary-o acpt-btn-block",onClick:s=>{s.preventDefault(),s.stopPropagation(),p()},children:a("Upload an Image")})]}):e.jsxs(v.Fragment,{children:[e.jsx("div",{className:"form-group",children:e.jsx("input",{type:"text",className:"form-control",placeholder:a("Type at least 3 characters to start searching."),onChange:async s=>{const t=s.currentTarget.value;t.length===0&&h(),t.length>=3&&j(t)}})}),l.length>0&&e.jsx("div",{className:"mt-24 icon-picker-wrapper","data-cy":"icon-picker-wrapper",children:l.map(s=>e.jsx(b,{isSelected:r===s,icon:s,callback:d}))})]})};y.propTypes={type:i.string.isRequired,defaultIcon:i.string,callback:i.func};const q=({callback:c,id:r,validate:d,register:l,description:f,defaultValue:u,errors:j})=>{const h=O(j,r),[p,s]=g.useState(u),[t,o]=g.useState(!1),[n,x]=g.useState(null),I=m=>{s(m),c(m),o(!1)};return g.useEffect(()=>{u!==null&&s(u)},[u]),e.jsxs(v.Fragment,{children:[t&&e.jsxs(S,{title:a("Choose icon"),visible:t,testId:r,children:[e.jsxs("div",{className:"text-left",children:[e.jsx("label",{className:"form-label",htmlFor:"icon-picker",children:a("Select icon type from the list")}),e.jsxs("select",{"data-cy":"select-icon",onChange:m=>{m.preventDefault(),m.stopPropagation(),x(m.currentTarget.value)},defaultValue:n,className:"form-control",id:"icon-picker",children:[e.jsx("option",{value:"",children:a("--Select--")}),e.jsx("option",{value:"dashicon",children:a("Select a Dashicon")}),e.jsx("option",{value:"image",children:a("Upload an icon image")})]})]}),n&&e.jsx("div",{className:"mt-8",children:e.jsx(y,{type:n,defaultIcon:p,callback:I})})]}),e.jsxs("div",{className:"flex-center s-8",children:[p&&e.jsx(C,{value:p}),e.jsx("input",{id:r,name:r,type:"text","data-cy":"input-icon",value:p||"",className:"hidden",...l(r,d)}),e.jsx(k,{onClick:m=>{m.preventDefault(),m.stopPropagation(),o(!t)},style:R.SECONDARY,size:"sm",testId:r,children:a("Choose icon")})]}),f&&e.jsx("div",{className:"form-description",children:f}),h&&e.jsx("div",{"data-cy":"input-error-icon",className:"invalid-feedback",children:h.message})]})};q.propTypes={id:i.string.isRequired,defaultValue:i.string,description:i.string,callback:i.func,validate:i.func,register:i.func.isRequired,errors:i.array.isRequired};const T=({id:c,register:r,setValue:d,defaultValue:l,description:f})=>{const u=g.useRef(null),j=g.useRef(null),h=()=>{const t=u.current.value,o=j.current.value;if(t&&o){const n=t==="after"?parseInt(o)+1:parseInt(o)-1;d(c,n)}},p=()=>{const t=n=>{const x=n.replace(/(<([^>]+)>)/gi,"");return n.length!==x.length?n.split(" ")[0]:n};let o=[];for(const[n,x]of Object.entries(document.globals.menu))o.push({label:x[0]!==""?t(x[0]):"----",value:n});return o},s=()=>{if(!l)return{position:null,menu:null};for(const[n,x]of Object.entries(document.globals.menu)){if(parseInt(n)+1===l)return{position:"after",menu:n};if(parseInt(n)-1===l)return{position:"before",menu:n}}const o=Object.keys(document.globals.menu).findIndex(n=>parseInt(n)===parseInt(l));return Object.entries(document.globals.menu)[o+1]?{position:"before",menu:Object.entries(document.globals.menu)[o+1][0]}:Object.entries(document.globals.menu)[o-1]?{position:"after",menu:Object.entries(document.globals.menu)[o-1][0]}:{position:null,menu:null}};return e.jsxs(v.Fragment,{children:[e.jsx(P,{register:r,id:c,value:l}),e.jsxs("div",{className:"i-flex-center s-8",children:[e.jsx("div",{className:"acpt-select",children:e.jsxs("select",{ref:u,"data-cy":`position-${c}`,className:"form-control",onChangeCapture:h,defaultValue:s().position,children:[e.jsx("option",{value:"",children:a("Select")}),e.jsx("option",{value:"after",children:a("After")}),e.jsx("option",{value:"before",children:a("Before")})]})}),e.jsx("div",{className:"acpt-select",children:e.jsxs("select",{ref:j,"data-cy":`menu-${c}`,className:"form-control",onChangeCapture:h,defaultValue:s().menu,children:[e.jsx("option",{value:"",children:a("Select")}),p().map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))]})})]}),f&&e.jsx("div",{className:"form-description",children:f})]})};T.propTypes={id:i.string.isRequired,defaultValue:i.number,description:i.string,setValue:i.func.isRequired,register:i.func.isRequired};export{q as I,T as M};
