import{j as e,u as s,f as w,d as We,e as Cl,g as Rl,h as Sl,i as El,k as ql,b as ke}from"./fields-GHpMjljq.js";import{R as O,a as k,u as pe,j as kl,h as Fl}from"./vendor-BmsXziqF.js";import{a as ye,B as we,M as ce,u as Il,L as Al,s as Ol}from"./Layout-6tbtb2_L.js";import{P as a,a as K,aC as X,s as V,I as U,u as W,B as Y,aD as ms,w as re,n as de,J as Ne,aE as ge,aF as Xe,aG as ps,aH as Je,ai as De,aj as Qe,aI as Ze,aJ as es,aK as xs,aL as bs,aM as Be,aN as Ml,v as oe,aO as fs,A as me,aP as gs,aQ as vs,aR as js,aS as Ve,aT as ys,i as Q,aU as wl,aV as Dl,aW as Bl,aX as Me,aY as Vl,aZ as $l,a_ as Ll,a$ as _l,b0 as Gl,b1 as Pl,b2 as Ee,b3 as Ul,b4 as os,b5 as Kl,b6 as Hl,b7 as Yl,b8 as zl,b9 as Wl,ba as Xl,bb as ss,bc as rs,bd as ls,ap as Ns,aq as Ts,be as Cs,as as Rs,bf as Ss,bg as Jl,av as Ql,m as ds,c as Zl,L as et,bh as st,bi as ze,bj as lt}from"./index-N_DirKM7.js";import{u as G,a as M,c as ne,g as ts,b as tt,F as at}from"./index.esm-Cy9FKwRd.js";import{I as Z}from"./Input-ClJTi6Yp.js";import{T as P}from"./index-CmFkX8j0.js";import{a as $e}from"./validation-CIogi1T7.js";import{I as he}from"./InputHidden-CbKoMq6o.js";import{d as Ie,w as Ae}from"./bundle.esm.min-B-HQpnrw.js";import{u as Te,C as Ce,a as Re}from"./sortable.esm-FQQt9Bz4.js";import{M as Es}from"./index-BK6Luaau.js";import{B as je}from"./ButtonSwitch-BwWOziYs.js";import{C as cs}from"./index-D7G017Q_.js";import{T as nt,a as Oe}from"./index-BjKxxx07.js";import{L as fe}from"./Label-BSdZmFpZ.js";import{S as ve,L as it}from"./index-BmCAbJhb.js";import{u as xe}from"./index-CrI7X7RI.js";import{S as se}from"./Select-DTKZAkjT.js";import{m as J}from"./metaTypes-Bb9tjSPe.js";import{S as Fe}from"./SelectMulti-9Pw5eHdu.js";import{S as as}from"./index-B-IqvbBi.js";import{P as ot}from"./index-CNI3N7GO.js";import"./index-BwVKM9Kw.js";const qs=({level:i,boxIndex:t,fieldIndex:o,blockIndex:n,boxId:r,parentField:l,block:d})=>{const{group:v}=K(h=>h.metaState),{control:b}=G(),m=M({control:b,name:`${X(v.boxes,r,l.id)}.blocks.${n}.name`});return e.jsxs(O.Fragment,{children:[e.jsxs("div",{className:"tree-el flex-between s-8",style:{"--level":i},children:[e.jsx("span",{className:"cursor-pointer text-ellipsis",onClick:h=>{h.preventDefault(),ye(d.id)},children:m||d.name}),e.jsx(we,{style:V.DANGER,children:"B"})]},d.id),d.fields&&d.fields.length>0&&d.fields.map((h,T)=>e.jsx(Le,{level:i+1,boxIndex:t,fieldIndex:T,boxId:r,parentField:l,field:h}))]})};qs.propTypes={level:a.number.isRequired,boxIndex:a.number.isRequired,fieldIndex:a.number.isRequired,blockIndex:a.number.isRequired,boxId:a.string.isRequired,block:a.object.isRequired,parentField:a.object.isRequired};const Le=({level:i,boxIndex:t,fieldIndex:o,boxId:n,parentField:r,field:l})=>{const{group:d}=K(m=>m.metaState),{control:v}=G(),b=M({control:v,name:`${X(d.boxes,n,l.id)}.name`});return e.jsxs(O.Fragment,{children:[e.jsxs("div",{className:"tree-el flex-between s-8",style:{"--level":i},children:[e.jsx("span",{className:"cursor-pointer text-ellipsis",onClick:m=>{m.preventDefault(),ye(`lazy-${l.id}`)},children:b||l.name}),e.jsx(we,{style:r?V.WARNING:V.SECONDARY,children:r?"C":"F"})]},l.id),l.children&&l.children.length>0&&l.children.map((m,h)=>e.jsx(Le,{level:i+1,boxIndex:t,fieldIndex:h,boxId:n,parentField:l,field:m})),l.blocks&&l.blocks.map((m,h)=>e.jsx(qs,{boxIndex:t,block:m,blockIndex:h,boxId:n,level:i+1,parentField:l,fieldIndex:o}))]})};Le.propTypes={level:a.number.isRequired,fieldIndex:a.number.isRequired,boxIndex:a.number.isRequired,boxId:a.string.isRequired,field:a.object.isRequired,parentField:a.object};const ks=({index:i,box:t})=>{const{control:o}=G(),n=M({control:o,name:`boxes.${i}.name`}),l=document.globals.globals,[d,v]=k.useState(!1);return e.jsxs("div",{className:"b-rounded with-shadow bg-white p-24",children:[e.jsxs("h3",{className:`${!d&&t.fields&&t.fields.length>0?"mb-24":""} flex-between s-8`,children:[e.jsx("span",{className:"cursor-pointer top-2",onClick:()=>v(!d),children:e.jsx(U,{width:18,icon:d?"bx:chevron-up":"bx:chevron-down",color:"#777"})}),e.jsx("span",{className:"text-ellipsis cursor-pointer",onClick:b=>{b.preventDefault(),ye(t.id)},children:n||t.name})]}),!d&&t.fields&&t.fields.length>0&&e.jsx("div",{className:`tree ${l.is_rtl===!0?"rtl":""}`,children:t.fields.map((b,m)=>e.jsx(O.Fragment,{children:e.jsx(Le,{level:0,boxIndex:i,fieldIndex:m,boxId:t.id,field:b})}))})]},t.id)};ks.propTypes={index:a.number.isRequired,box:a.object.isRequired};const Fs=({boxes:i})=>typeof i>"u"||i.length===0?null:e.jsx(O.Fragment,{children:i&&i.map((t,o)=>e.jsx(ks,{index:o,box:t}))});Fs.propTypes={boxes:a.array.isRequired};const Is=({index:i,boxId:t,setActiveTab:o})=>{const n=W(),{control:r}=G(),{remove:l}=ne({control:r,name:"boxes"}),[d,v]=k.useState(!1),b=[e.jsx(Y,{style:V.SUCCESS,onClick:m=>{m.preventDefault(),n(ms(t)),l(i),v(!d),o&&o(0)},children:s("Yes")}),e.jsx(Y,{style:V.DANGER,onClick:m=>{m.preventDefault(),v(!d)},children:s("No")})];return e.jsxs(O.Fragment,{children:[e.jsx(ce,{title:s("Confirm deleting meta box"),visible:d,buttons:b,children:s("Are you sure?")}),e.jsx("a",{href:"#",onClick:m=>{m.preventDefault(),v(!d)},children:e.jsx(U,{icon:"bx-trash",width:18})})]})};Is.propTypes={setActiveTab:a.func,index:a.number.isRequired,boxId:a.string.isRequired};const As=({box:i})=>{const o=document.globals.globals,{setValue:n}=G(),r=W(),{id:l}=pe(),[d,v]=k.useState(!1),[b,m]=k.useState(null),[h,T]=k.useState(!1);k.useEffect(()=>{m(null),T(!1)},[d]);const y=()=>{re("copyMetaBoxAction",{boxId:i.id,targetGroupId:b,delete:h}).then(u=>{u.success?(de.success(`${s("Meta box was successfully copied")}.`),v(!d),l===i.groupId&&r(Ne({id:l})).then(c=>{r(ge(c.payload)),n("id",l),n("name",c.payload.name),n("label",c.payload.label),n("display",c.payload.display),c.payload.belongs&&c.payload.belongs.map((x,j)=>{n(`belongs.${j}.id`,x.id),n(`belongs.${j}.belongsTo`,x.belongsTo),n(`belongs.${j}.operator`,x.operator),n(`belongs.${j}.find`,x.find),n(`belongs.${j}.logic`,x.logic)}),c.payload.boxes&&c.payload.boxes.map((x,j)=>{n(`boxes.${j}`,x)})}).catch(c=>{console.error(c)})):de.error(u.error)}).catch(u=>console.error(u))};return e.jsxs(O.Fragment,{children:[e.jsx(ce,{title:s("Copy this meta box"),visible:d,buttons:[],children:e.jsxs("div",{className:"flex-column s-24",children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label i-flex-center s-4",htmlFor:"group",children:s("Meta group")}),e.jsx("div",{className:"acpt-select",children:e.jsx("select",{id:"group",className:"form-control default",onChangeCapture:u=>m(u.target.value),children:o.find.meta.map(u=>e.jsx("option",{value:u.value,children:u.label}))})})]}),b&&b!=="Select"&&e.jsxs("div",{children:[e.jsxs("div",{className:"w-100 i-flex-center s-4 mb-8",children:[e.jsx("input",{type:"checkbox",defaultValue:h,onClick:()=>T(!h),id:"deleteBox"}),e.jsx("label",{htmlFor:"deleteBox",children:s("Delete the meta box after copying")})]}),e.jsx(Y,{onClick:()=>y(),style:V.PRIMARY,children:s("Copy")})]})]})}),e.jsx("a",{href:"",onClick:u=>{u.preventDefault(),v(!d)},children:e.jsx(U,{icon:"bx:copy",width:18})})]})};As.propTypes={box:a.object.isRequired};const Se=({element:i,elementType:t})=>{const o=W(),{selectedElements:n}=K(l=>l.metaState),r=()=>n.filter(d=>d.id===i.id).length>0;return e.jsx(P,{label:e.jsxs("label",{className:"checkbox",htmlFor:`select-${i.id}`,style:{top:"3px"},children:[e.jsx("input",{id:`select-${i.id}`,type:"checkbox",checked:r(),onChange:l=>{o(Xe({element:i,selected:l.target.checked,type:t}))}}),e.jsx("span",{})]}),icon:!1,tip:s(r()?"Deselect this element":"Select this element")})};Se.propTypes={element:a.object.isRequired,elementType:a.oneOf(["box","block","field"]).isRequired};function Os(i,t,o){var n,r,l,d,v,b=function(){var h=us()-r;t>h?n=setTimeout(b,t-h):(n=null,d=i.apply(v,l),n||(l=v=null))},m=rt(function(h){return v=this,l=h,r=us(),n||(n=setTimeout(b,t)),d});return m.cancel=function(){clearTimeout(n),n=l=v=null},m}function us(){return new Date().getTime()}function rt(i,t){return t=t==null?i.length-1:+t,function(){for(var o=Math.max(arguments.length-t,0),n=Array(o),r=0;r<o;r++)n[r]=arguments[r+t];switch(t){case 0:return i.call(this,n);case 1:return i.call(this,arguments[0],n);case 2:return i.call(this,arguments[0],arguments[1],n)}var l=Array(t+1);for(r=0;r<t;r++)l[r]=arguments[r];return l[t]=n,i.apply(this,l)}}const Ms=({index:i,box:t,view:o,listeners:n,attributes:r,setActiveTab:l})=>{const d=B=>`boxes.${i}.${B}`,{register:v,formState:{errors:b},control:m,setValue:h,resetField:T,clearErrors:y,setError:u}=G(),c=M({control:m,name:d("name")}),x=M({control:m,name:d("label")}),j=M({control:m,name:`boxes.${i}`}),C=M({control:m,name:"boxes"}),{append:E}=ne({control:m,name:"boxes"}),q=W(),{closedElements:I,selectedElements:g,selectedElementsType:f}=K(B=>B.metaState),p=()=>I.filter(_=>_===t.id).length===1,[S,A]=k.useState(!1),[F,R]=k.useState(!0),N=()=>{const B=d("name"),_=ts(b,B);return _?e.jsx("span",{className:"invalid-feedback",children:s(_.message)}):c||t.name},D=()=>typeof x=="string"?x:t.label,L=async B=>{if(F){const _=Ie(Ae(B));h(d("name"),_),await le(_)?u(d("name"),{message:s("Name is already taken")}):y(d("name"))}},le=async B=>{let _=[];if(C.map((z,te)=>{te!==i&&_.push(z.name)}),_.includes(B))return s("Name is already taken");if(t.name!==B&&(await re("checkMetaBoxNameAction",{boxName:B})).exists===!0)return s("Name is already taken")},ue=()=>{Qe(t.id),p()?q(Ze({id:t.id})):q(es({id:t.id}))},H=()=>!(typeof t.isSaved<"u"&&t.isSaved===!1),$=()=>{const B=()=>{const _=t&&t.fields&&t.fields.length>0?t.fields[0].id:null,z=g.filter(te=>te.id===_);return!!(z&&z.length===1)};t&&t.fields&&t.fields.map(_=>{q(Xe({element:_,selected:!B(),type:"field"}))})},ee=()=>{let B="flex-between s-8 for-xs";return o==="accordion"&&(B=B+" p-24 bg-pale-gray",p()||(B=B+" b-bottom-1")),B};return e.jsxs("div",{className:ee(),children:[e.jsx(he,{id:d("id"),value:t.id,register:v}),e.jsxs("span",{className:"i-flex-center s-8",children:[(o==="list"||o==="accordion")&&e.jsx("span",{className:"cursor-move top-2 handle",...r,...n,children:e.jsx(U,{icon:"bx:dots-vertical-rounded",color:"#777",width:18})}),f!=="field"&&f!=="block"&&H()&&e.jsx(Se,{elementType:"box",element:{id:t.id}}),e.jsx("h3",{className:`${S?"hidden":""}`,children:N()}),e.jsx("span",{className:`top-1 color-gray ${S?"hidden":""}`,children:D()}),e.jsxs("div",{className:`i-flex-center s-8 ${S?"":"hidden"}`,children:[e.jsx("div",{children:e.jsx(Z,{size:"sm",id:d("label"),placeholder:s("Box label, non latin chars allowed."),defaultValue:t.name,register:v,errors:b,required:!0,onChangeCapture:Os(B=>{L(B.target.value)},300),onClick:B=>{(B.target.value==="meta_box_title"||B.target.value==="meta box title")&&T(d("label"))},validate:{maxLength:{value:255,message:"max length is 255"}}})}),e.jsx("div",{children:e.jsx(Z,{size:"sm",id:d("name"),placeholder:s("Box name. Allowed chars: [a-z0-9_-]"),defaultValue:t.name,register:v,errors:b,required:!0,onClick:B=>{B.target.value==="meta_box_title"&&T(d("name"))},validate:{validate:{alphanumericallyValid:$e,checkIfNameIsValid:le},required:s("This field is mandatory"),maxLength:{value:255,message:"max length is 255"}}})}),e.jsx(P,{label:e.jsx("span",{className:`acpt-btn-switch ${F===!0?"active":""}`,onClick:B=>{B.preventDefault(),R(!F)},children:e.jsx(U,{icon:"bx-link",width:18})}),tip:s(`${F?"Auto slug ON":"Auto slug OFF"}`),icon:!1})]}),e.jsx(Y,{style:V.SECONDARY,size:"sm",onClick:B=>{B.preventDefault(),A(!S)},children:s(`${S?"Close":"Edit"}`)})]}),e.jsxs("span",{className:"i-flex-center s-8",children:[e.jsx(P,{label:e.jsx("a",{href:"#",onClick:B=>{B.preventDefault(),$()},children:e.jsx(U,{icon:"bx:checkbox-checked",width:24})}),tip:s("Select/deselect all fields"),icon:!1}),e.jsx(P,{label:e.jsx("a",{href:"#",onClick:B=>{B.preventDefault();const _=ps(j);q(Je(_)),E(_),De(1).then(()=>{ye(_.id)})},children:e.jsx(U,{icon:"bx:duplicate",width:18})}),tip:s("Duplicate this meta box"),icon:!1}),H()&&e.jsx(O.Fragment,{children:e.jsx(P,{label:e.jsx(As,{box:t}),tip:s("Copy this meta box"),icon:!1})}),e.jsx(P,{label:e.jsx(Is,{index:i,setActiveTab:l,boxId:t.id}),tip:s("Delete this meta box"),icon:!1}),(o==="list"||o==="accordion")&&e.jsx(P,{label:e.jsx("a",{href:"#",onClick:B=>{B.preventDefault(),ue()},children:e.jsx(U,{icon:"bx:expand-alt",width:18})}),tip:s("Hide/show this meta box"),icon:!1})]})]})};Ms.propTypes={box:a.object.isRequired,view:a.oneOf(["list","tabular"]).isRequired,setActiveTab:a.func,attributes:a.object,listeners:a.object};const ws=({boxId:i,fieldId:t,fieldIndex:o,parentFieldId:n,parentBlockId:r,setActiveTab:l})=>{const d=W(),{group:v}=K(c=>c.metaState),b=()=>X(v.boxes,i,t,!1),[m,h]=k.useState(!1),{control:T}=G(),{remove:y}=ne({control:T,name:b()}),u=[e.jsx(Y,{style:V.SUCCESS,onClick:c=>{c.preventDefault(),d(xs({boxId:i,parentFieldId:n,parentBlockId:r,fieldId:t})),y(o),h(!m),l&&l(0)},children:s("Yes")}),e.jsx(Y,{style:V.DANGER,onClick:c=>{c.preventDefault(),h(!m)},children:s("No")})];return e.jsxs(O.Fragment,{children:[e.jsx(ce,{title:s("Confirm deleting meta field"),visible:m,buttons:u,children:s("Are you sure?")}),e.jsx("a",{href:"#",onClick:c=>{c.preventDefault(),h(!m)},children:e.jsx(U,{icon:"bx-trash",width:18})})]})};ws.propTypes={setActiveTab:a.func,boxId:a.string.isRequired,fieldId:a.string.isRequired,fieldIndex:a.number.isRequired,parentFieldId:a.string,parentBlockId:a.string};const Ds=({boxId:i,field:t,parentFieldId:o,parentBlockId:n})=>{const{group:r}=K(F=>F.metaState),l=r.boxes.findIndex(F=>F.id===i),d=X(r.boxes,i,t.id),v=d.split("."),[b,m]=k.useState(!1),[h,T]=k.useState([]),[y,u]=k.useState(null),[c,x]=k.useState(!1),{control:j}=G(),C=M({control:j,name:"belongs"}),E=M({control:j,name:`boxes.${l}.name`}),q=M({control:j,name:d}),I=M({control:j,name:`boxes.${l}.fields.${v[3]}.name`});let g=null,f=null,p=v[v.length-1],S=n?v[v.length-3]:null;n&&(g=M({control:j,name:X(r.boxes,i,n)})),o&&(f=M({control:j,name:X(r.boxes,i,o)})),k.useEffect(()=>{c&&(m(!0),re("calculateShortCodeAction",{belongsTo:C,boxName:E,fieldId:t.id,fieldName:q?q.name:t.name,fieldRootName:I,parentBlockName:g?g.name:null,parentFieldName:f?f.name:null,index:p,blockIndexInfo:S}).then(F=>{u(F.metaKey),T(F.shortcodes),m(!1)}).catch(F=>{console.error(F.message),m(!1)}))},[c]);const A=[e.jsx(Y,{style:V.DANGER,onClick:F=>{F.preventDefault(),x(!c)},children:s("Close")})];return e.jsxs(O.Fragment,{children:[e.jsx(ce,{title:s("Shortcode preview"),visible:c,padding:0,buttons:A,children:b?e.jsx("div",{className:"b-bottom-1 p-24",children:s("Loading...")}):e.jsxs(O.Fragment,{children:[y&&e.jsxs("div",{className:"b-bottom-1 p-24",children:[e.jsx("div",{className:"mb-8 color-black",children:e.jsx(P,{label:s("Meta-key"),tip:e.jsxs("div",{className:"flex-column s-8 color-gray",children:[e.jsx("div",{children:s("This is the meta-key of this field.")}),e.jsx("div",{children:s("Use it in functions like get_post_meta() to retrieve saved meta field data.")})]})})}),e.jsx(cs,{text:y})]}),h&&h.length>0&&e.jsxs("div",{className:"p-24",children:[e.jsx("div",{className:"mb-8 color-black",children:e.jsx(P,{label:h&&h.length>1?s("Shortcodes"):s("Shortcode"),tip:e.jsx("div",{className:"flex-column s-8 color-gray",children:e.jsx("div",{children:s("Use this shortcode to display the meta field on your frontend.")})})})}),h&&e.jsx("div",{className:"flex-column s-8",children:h.map(F=>e.jsx(cs,{text:F}))})]})]})}),e.jsx("a",{href:"#",onClick:F=>{F.preventDefault(),x(!c)},children:e.jsx(U,{icon:"bx:code-alt",width:18})})]})};Ds.propTypes={boxId:a.string.isRequired,field:a.object.isRequired,parentFieldId:a.string,parentBlockId:a.string};const Bs=({field:i})=>{const o=document.globals.globals,{setValue:n}=G(),r=W(),{id:l}=pe(),[d,v]=k.useState(!1),[b,m]=k.useState(null),[h,T]=k.useState([]),[y,u]=k.useState([]),[c,x]=k.useState([]),[j,C]=k.useState(null),[E,q]=k.useState(null),[I,g]=k.useState(!1);k.useEffect(()=>{m(null),T([]),u([]),x([]),C(null),q(null),g(!1)},[d]);const f=R=>{m(R),T([]),u([]),x([]),C(null),q(null),g(!1),re("fetchMetaAction",{id:R}).then(N=>{T(N.boxes)}).catch(N=>console.error(N))},p=R=>{u([]),x([]),C("box"),q(R);const N=h.filter(D=>D.id===R)[0].fields;if(N&&N.length>0){const D=N.filter(L=>L.type===w.REPEATER||L.type===w.FLEXIBLE);D&&D.length>0&&u(D)}},S=R=>{C("field"),q(R);const N=y.filter(D=>D.id===R)[0].blocks;N&&N.length>0&&x(N)},A=R=>{C("block"),q(R)},F=()=>{re("copyMetaFieldAction",{fieldId:i.id,targetEntityType:j,targetEntityId:E,delete:I}).then(R=>{R.success?(de.success(`${s("Meta field was successfully copied")}.`),v(!d),l===i.groupId&&r(Ne({id:l})).then(N=>{r(ge(N.payload)),n("id",l),n("name",N.payload.name),n("label",N.payload.label),n("display",N.payload.display),N.payload.belongs&&N.payload.belongs.map((D,L)=>{n(`belongs.${L}.id`,D.id),n(`belongs.${L}.belongsTo`,D.belongsTo),n(`belongs.${L}.operator`,D.operator),n(`belongs.${L}.find`,D.find),n(`belongs.${L}.logic`,D.logic)}),N.payload.boxes&&N.payload.boxes.map((D,L)=>{n(`boxes.${L}`,D)})}).catch(N=>{de.error(`${s("Something went wrong, please retry.")}`)})):de.error(R.error)}).catch(R=>{de.error(`${s("Something went wrong, please retry.")}`)})};return e.jsxs(O.Fragment,{children:[e.jsx(ce,{title:s("Copy this meta field"),visible:d,buttons:[],children:e.jsxs("div",{className:"flex-column s-24",children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label i-flex-center s-4",htmlFor:"group",children:s("Meta group")}),e.jsx("div",{className:"acpt-select",children:e.jsx("select",{id:"group",className:"form-control default",onChangeCapture:R=>f(R.target.value),children:o.find.meta.map(R=>e.jsx("option",{value:R.value,children:R.label}))})})]}),h&&h.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"form-label i-flex-center s-4",htmlFor:"box",children:s("Meta box")}),e.jsx("div",{className:"acpt-select",children:e.jsxs("select",{id:"box",className:"form-control default",onChangeCapture:R=>p(R.target.value),children:[e.jsx("option",{value:null,children:s("Select")}),h.map(R=>e.jsx("option",{value:R.id,children:R.name}))]})})]}),y&&y.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"form-label i-flex-center s-4",htmlFor:"field",children:s("Meta field")}),e.jsx("div",{className:"acpt-select",children:e.jsxs("select",{id:"field",className:"form-control default",onChangeCapture:R=>S(R.target.value),children:[e.jsx("option",{value:null,children:s("Select")}),y.map(R=>e.jsx("option",{value:R.id,children:R.name}))]})})]}),c&&c.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"form-label i-flex-center s-4",htmlFor:"field",children:s("Meta block")}),e.jsx("div",{className:"acpt-select",children:e.jsxs("select",{id:"block",className:"form-control default",onChangeCapture:R=>A(R.target.value),children:[e.jsx("option",{value:null,children:s("Select")}),c.map(R=>e.jsx("option",{value:R.id,children:R.name}))]})})]}),j&&E&&e.jsxs("div",{children:[e.jsxs("div",{className:"w-100 i-flex-center s-4 mb-8",children:[e.jsx("input",{type:"checkbox",defaultValue:I,onClick:()=>g(!I),id:"deleteField"}),e.jsx("label",{htmlFor:"deleteField",children:s("Delete the meta field after copying")})]}),e.jsx(Y,{onClick:()=>F(),style:V.PRIMARY,children:s("Copy")})]})]})}),e.jsx("a",{href:"#",onClick:R=>{R.preventDefault(),v(!d)},children:e.jsx(U,{icon:"bx:copy",width:18})})]})};Bs.propTypes={field:a.object.isRequired};const Vs=k.memo(({boxId:i,field:t,view:o,listeners:n,attributes:r,formId:l,boxIndex:d,fieldIndex:v,parentFieldId:b,parentBlockId:m,setActiveTab:h})=>{const T=W(),{group:y,closedElements:u,selectedElements:c,selectedElementsType:x}=K(_=>_.metaState),{formState:{errors:j},control:C}=G(),E=M({control:C,name:l("name")}),q=M({control:C,name:l("label")}),I=M({control:C,name:l("type")}),g=M({control:C,name:`boxes.${d}.fields.${v}`}),f=M({control:C,name:l("showInArchive")}),p=M({control:C,name:l("filterableInAdmin")}),S=M({control:C,name:l("quickEdit")}),A=M({control:C,name:l("isRequired")}),{append:F}=ne({control:C,name:X(y.boxes,i,t.id,!1)}),R=()=>u.filter(z=>z===t.id).length===1,N=()=>{const _=l("name"),z=ts(j,_);return z?e.jsx("span",{className:"invalid-feedback",children:s(z.message)}):E||t.name},D=()=>typeof q=="string"?q:t.label,L=()=>I||t.type,le=()=>L()!==w.REPEATER&&L()!==w.FLEXIBLE,ue=()=>t.parentId||t.blockId,H=()=>{Qe(t.id),R()?T(Ze({id:t.id})):T(es({id:t.id}))},$=()=>!(typeof t.isSaved<"u"&&t.isSaved===!1),ee=()=>L()===w.REPEATER||L()===w.FLEXIBLE,B=()=>{const _=()=>{const z=t&&t.children&&t.children.length>0?t.children[0].id:null,te=c.filter(ae=>ae.id===z);return!!(te&&te.length===1)};t&&t.children&&t.children.map(z=>{T(Xe({element:z,selected:!_(),type:"field"}))})};return e.jsxs("div",{className:`flex-between s-8 for-xs ${o==="accordion"&&!R()?"mb-24":""}`,children:[e.jsxs("span",{className:"i-flex-center s-8 fox-xs",children:[(o==="list"||o==="accordion")&&e.jsx("span",{className:"cursor-move top-2 handle",...r,...n,children:e.jsx(U,{icon:"bx:dots-vertical-rounded",color:"#777",width:18})}),x!=="box"&&x!=="block"&&$()&&e.jsx(Se,{elementType:"field",element:{id:t.id,boxId:i,parentFieldId:b,parentBlockId:m}}),e.jsxs("div",{className:"i-flex-center s-8 text-ellipsis",style:o==="accordion"?{width:"200px"}:{},children:[e.jsx("h3",{children:N()}),e.jsx("span",{className:"top-1 color-gray",children:D()})]}),e.jsx("span",{className:"color-gray",children:e.jsx(Es,{fieldType:L(),css:"with-border b-rounded p-4 top-2"})}),e.jsxs("span",{className:"i-flex-center s-8",children:[e.jsx(P,{label:e.jsx(je,{id:l("showInArchive"),control:C,defaultValue:typeof f=="boolean"?f:t.showInArchive,errors:j,icon:"bxl:wordpress"}),tip:s("Show in Wordpress admin post lists page"),icon:!1}),le()&&e.jsxs(O.Fragment,{children:[!ue()&&e.jsxs(O.Fragment,{children:[e.jsx(P,{label:e.jsx(je,{control:C,defaultValue:typeof p=="boolean"?p:t.filterableInAdmin,errors:j,icon:"bx:filter",id:l("filterableInAdmin")}),tip:s("Filterable in Wordpress admin post lists page"),icon:!1}),e.jsx(P,{label:e.jsx(je,{control:C,defaultValue:typeof S=="boolean"?S:t.quickEdit,errors:j,icon:"bx:pencil",id:l("quickEdit")}),tip:s("Quick edit in Wordpress admin post lists page"),icon:!1})]}),e.jsx(P,{label:e.jsx(O.Fragment,{children:e.jsx(je,{control:C,defaultValue:typeof A=="boolean"?A:t.isRequired,errors:j,icon:"foundation:asterisk",id:l("isRequired")})}),tip:s("Field required"),icon:!1})]})]})]}),e.jsxs("span",{className:"i-flex-center s-8",children:[ee()&&e.jsx(P,{label:e.jsx("a",{href:"#",onClick:_=>{_.preventDefault(),B()},children:e.jsx(U,{icon:"bx:checkbox-checked",width:24})}),tip:s("Select/deselect all fields"),icon:!1}),le()&&e.jsx(P,{label:e.jsx(Ds,{boxId:i,field:t,parentFieldId:b,parentBlockId:m}),tip:s("Show the shortcode"),icon:!1}),e.jsx(P,{label:e.jsx("a",{href:"#",onClick:_=>{_.preventDefault();const z=bs(i,g);T(Be({boxId:i,field:z})),F(z),De(1).then(()=>{ye(z.id)})},children:e.jsx(U,{icon:"bx:duplicate",width:18})}),tip:s("Duplicate this meta field"),icon:!1}),$()&&e.jsx(P,{label:e.jsx(Bs,{field:t}),tip:s("Copy this meta field"),icon:!1}),e.jsx(P,{label:e.jsx(ws,{setActiveTab:h,boxId:i,fieldId:t.id,fieldIndex:v,parentFieldId:b,parentBlockId:m}),tip:s("Delete this meta field"),icon:!1}),(o==="list"||o==="accordion")&&e.jsx(P,{label:e.jsx("a",{href:"#",onClick:_=>{_.preventDefault(),H()},children:e.jsx(U,{icon:"bx:expand-alt",width:18})}),tip:s("Hide/show this meta field"),icon:!1})]})]})});Vs.propTypes={boxIndex:a.number.isRequired,fieldIndex:a.number.isRequired,formId:a.func.isRequired,boxId:a.string.isRequired,parentFieldId:a.string,parentBlockId:a.string,field:a.object.isRequired,view:a.oneOf(["list","tabular"]).isRequired,attributes:a.object,listeners:a.object,setActiveTab:a.func};const $s=({boxId:i,fieldId:t,optionId:o,parentFieldId:n,optionIndex:r})=>{const l=W(),{group:d}=K(u=>u.metaState),v=()=>`${X(d.boxes,i,t)}.options`,[b,m]=k.useState(!1),{control:h}=G(),{remove:T}=ne({control:h,name:v()}),y=[e.jsx(Y,{style:V.SUCCESS,onClick:u=>{u.preventDefault(),l(Ml({boxId:i,fieldId:t,parentFieldId:n,optionId:o})),T(r),m(!b)},children:s("Yes")}),e.jsx(Y,{style:V.DANGER,onClick:u=>{u.preventDefault(),m(!b)},children:s("No")})];return e.jsxs("span",{children:[e.jsx(ce,{title:s("Confirm deleting option"),visible:b,buttons:y,children:s("Are you sure?")}),e.jsx("a",{href:"#",onClick:u=>{u.preventDefault(),m(!b)},children:e.jsx(P,{icon:!1,tip:s("Delete"),label:e.jsx(U,{icon:"bx-minus"})})})]})};$s.propTypes={boxId:a.string.isRequired,fieldId:a.string.isRequired,parentFieldId:a.string,optionId:a.string.isRequired,optionIndex:a.number.isRequired};const Ls=({index:i,boxIndex:t,fieldIndex:o,boxId:n,fieldId:r,parentFieldId:l,option:d,handleIsDefault:v})=>{const{group:b}=K(N=>N.metaState),m=N=>l?`${X(b.boxes,n,r)}.options.${i}.${N}`:`boxes.${t}.fields.${o}.options.${i}.${N}`,{register:h,formState:{errors:T},control:y,setValue:u,resetField:c}=G(),x=M({control:y,name:m("value")}),j=M({control:y,name:m("label")}),C=M({control:y,name:m("isDefault")}),{attributes:E,listeners:q,setNodeRef:I,transform:g}=Te({id:d.id}),f={transform:Ce.Translate.toString(g)},p=()=>d.label==="label"&&d.value==="value"?!0:d.label===d.value,[S,A]=k.useState(p()),F=()=>x||(d.value?d.value:null),R=()=>j||(d.label?d.label:null);return e.jsxs("div",{className:"i-flex-center s-8",style:f,ref:I,children:[e.jsx(he,{id:m("id"),value:d.id,register:h}),e.jsx("span",{className:"cursor-move top-2 handle",...E,...q,children:e.jsx(U,{icon:"bx:dots-vertical-rounded",color:"#777",width:18})}),e.jsx("span",{className:"w-100",children:e.jsx(Z,{id:m("label"),register:h,errors:T,defaultValue:R(),onChangeCapture:N=>{S&&u(m("value"),N.target.value)},onClick:N=>{d.label&&N.target.value==="label"&&c(m("label"))},validate:{required:s("This field is mandatory"),maxLength:{value:255,message:"max length is 255"}}})}),e.jsx("span",{className:"w-100",children:e.jsx(Z,{id:m("value"),register:h,errors:T,defaultValue:F(),onChangeCapture:N=>{S&&u(m("label"),N.target.value)},onClick:N=>{d.value&&N.target.value==="value"&&c(m("value"))},validate:{required:s("This field is mandatory"),maxLength:{value:255,message:"max length is 255"}}})}),e.jsxs("span",{className:"i-flex-center s-8",children:[e.jsx(P,{label:e.jsx("button",{type:"button",className:`acpt-btn-switch ${S?"active":""}`,onClick:N=>{N.preventDefault(),A(!S)},children:e.jsx(U,{icon:"bx:bx-link",width:"18px"})}),tip:s(S?"Label and value are linked":"Label and value are unlinked"),icon:!1}),e.jsx(P,{label:e.jsx(je,{control:y,defaultValue:typeof C=="boolean"?C:d.isDefault,errors:T,icon:"bx:check",id:m("isDefault"),externalOnChange:v}),tip:s("Default value"),icon:!1})]}),e.jsx($s,{boxId:n,fieldId:r,optionId:d.id,parentFieldId:l,optionIndex:i})]})};Ls.propTypes={index:a.number.isRequired,boxIndex:a.number.isRequired,fieldIndex:a.number.isRequired,boxId:a.string.isRequired,fieldId:a.string.isRequired,parentFieldId:a.string,option:a.object.isRequired,handleIsDefault:a.func};const _s=({boxId:i,fieldId:t,parentFieldId:o})=>{const n=W(),[r,l]=k.useState(!1),[d,v]=k.useState(null),[b,m]=k.useState(null),[h,T]=k.useState(!1);k.useEffect(()=>{h&&(l(!0),re("fetchDatasetsAction",{}).then(c=>{let x=[{value:null,label:s("Select"),items:[]}];c.records&&c.records.map(j=>{x.push({value:j.id,label:j.label?j.label:j.name,items:j.items?j.items:[]})}),v(x),l(!1)}).catch(c=>{console.error(c.message),l(!1)}))},[h]);const y=()=>{const c=d.filter(j=>j.value===b);if(c&&c.length!==1)return;c[0].items.map(j=>{const C={id:oe(),boxId:i,fieldId:t,label:j.label,value:j.value,isDefault:j.isDefault};n(fs({boxId:i,fieldId:t,parentFieldId:o,option:C}))}),de.success(s("Dataset loaded correctly")),T(!h)},u=[e.jsx(Y,{style:V.PRIMARY,disabled:b===null,onClick:c=>{c.preventDefault(),y()},children:s("Load dataset")}),e.jsx(Y,{style:V.DANGER,onClick:c=>{c.preventDefault(),T(!h)},children:s("Close")})];return e.jsxs(O.Fragment,{children:[e.jsx(ce,{title:s("Load dataset"),visible:h,padding:0,buttons:u,children:r?e.jsx("div",{className:"p-24",children:s("Loading...")}):e.jsx("div",{className:"p-24",children:e.jsx("select",{id:"dataset",className:"form-control default",onChangeCapture:c=>m(c.target.value),children:d&&d.map(c=>e.jsx("option",{value:c.value,children:c.label}))})})}),e.jsx("a",{href:"#",onClick:c=>{c.preventDefault(),T(!h)},children:s("Load dataset")})]})};_s.propTypes={boxId:a.string.isRequired,fieldId:a.string.isRequired,parentFieldId:a.string.isRequired};const Gs=({boxId:i,boxIndex:t,fieldIndex:o,fieldId:n,parentFieldId:r,options:l,isMulti:d})=>{const v=W(),{group:b}=K(E=>E.metaState),[m]=xe(),h=()=>`${X(b.boxes,i,n)}.options`,{control:T,setValue:y,resetField:u}=G(),{move:c}=ne({control:T,name:h()}),x=E=>{const{active:q,over:I}=E;if(q.id===I.id)return;const g=l.findIndex(p=>p.id===q.id),f=l.findIndex(p=>p.id===I.id);c(g,f)},j=()=>{const E={id:oe(),boxId:i,fieldId:n,label:"label",value:"value",isDefault:!1};v(fs({boxId:i,fieldId:n,parentFieldId:r,option:E}))},C=({id:E,checked:q})=>{if(!d)for(let I=0;I<l.length;I++){const g=h()+"."+I+".isDefault";g!==E?y(g,!1):y(g,q)}};return e.jsx("div",{className:"mt-24",children:e.jsxs("fieldset",{className:"acpt-fieldset",children:[e.jsx("legend",{children:s("Option list")}),e.jsx("div",{ref:m,className:"flex-column s-24",children:l&&l.length>0?e.jsx(ve,{onDragEnd:x,items:l,children:l&&l.map((E,q)=>e.jsx(Ls,{index:q,boxIndex:t,fieldIndex:o,boxId:i,fieldId:n,parentFieldId:r,option:E,handleIsDefault:C}))}):e.jsx(me,{style:V.WARNING,children:s('No options already created. Create the first one now by clicking the button "Add option"!')})}),e.jsxs("div",{className:"mt-24 i-flex-center s-8",children:[e.jsx("a",{href:"#",onClick:E=>{E.preventDefault(),j()},children:s("Add option")}),e.jsx(_s,{boxId:i,fieldId:n,parentFieldId:r})]})]})})};Gs.propTypes={boxId:a.string.isRequired,fieldId:a.string.isRequired,parentFieldId:a.string,boxIndex:a.number.isRequired,fieldIndex:a.number.isRequired,options:a.array.isRequired,isMulti:a.bool.isRequired};const Ps=({isActive:i,onClick:t,boxIndex:o,fieldIndex:n,boxId:r,field:l,parentFieldIndex:d,parentFieldId:v,parentBlockId:b})=>{const{group:m,selectedElementsType:h}=K(f=>f.metaState),T=f=>`${X(m.boxes,r,l.id)}.${f}`,{control:y}=G(),u=M({control:y,name:T("name")}),c=M({control:y,name:T("type")}),x=M({control:y,name:T("isRequired")}),{attributes:j,listeners:C,setNodeRef:E,transform:q}=Te({id:l.id}),I={transform:Ce.Translate.toString(q)},g=()=>!(typeof l.isSaved<"u"&&l.isSaved===!1);return e.jsx(O.Fragment,{children:e.jsx("div",{className:`acpt-btn-switch ${i?"active":""}`,ref:E,style:I,onClick:()=>{t(n)},children:e.jsxs("div",{className:"i-flex-center s-8",children:[e.jsx("span",{className:"cursor-move top-2 handle",...j,...C,onMouseDownCapture:()=>{t(n)},children:e.jsx(U,{icon:"bx:dots-vertical-rounded",color:"#777",width:18})}),h!=="box"&&h!=="block"&&g()&&e.jsx(Se,{elementType:"field",element:{id:l.id,boxId:r,parentFieldId:v,parentBlockId:b}}),e.jsxs("span",{className:"text-ellipsis",style:{maxWidth:"200px"},children:[u||l.name,x&&x===!0&&e.jsx("span",{children:"*"})]}),e.jsx(Es,{fieldType:c||l.type,css:"top-2"})]})})})};Ps.propTypes={boxIndex:a.number.isRequired,boxId:a.string.isRequired,fieldIndex:a.string.isRequired,field:a.object.isRequired,parentFieldIndex:a.string,parentFieldId:a.string,parentBlockId:a.string,isActive:a.bool.isRequired,onClick:a.func.isRequired};const _e=({boxIndex:i,boxId:t,fields:o,parentFieldIndex:n,parentFieldId:r,parentBlockId:l,addFieldEnabled:d=!0})=>{const v=W(),{group:b}=K(E=>E.metaState),m=()=>l?`${X(b.boxes,t,l)}.fields`:r?`${X(b.boxes,t,r)}.children`:`boxes.${i}.fields`,{control:h,getValues:T}=G(),{move:y}=ne({control:h,name:m()}),[u,c]=k.useState(0);k.useEffect(()=>{o[u]||c(0)},[o]);const x=E=>{c(E)},j=E=>{const{active:q,over:I}=E;if(q.id===I.id)return;const g=o.findIndex(S=>S.id===q.id),f=o.findIndex(S=>S.id===I.id),p=Re(o,g,f);y(g,f),c(f),v(gs({boxId:t,parentFieldId:r,parentBlockId:l,sortedFields:p}))},C=()=>{const E={id:oe(),boxId:t,name:"meta_box_field",label:"meta box field",type:w.TEXT,defaultValue:"",description:"",isRequired:!1,showInArchive:!1,quickEdit:!1,filterableInAdmin:!1,sort:1,advancedOptions:[],options:[],blocks:[],blockId:l||null,validationRules:[],visibilityConditions:[],hasManyRelation:[],children:[],parentId:r||null,isATextualField:!0,isFilterable:!0,isSaved:!1};v(Be({boxId:t,parentFieldId:r,parentBlockId:l,field:E})),c(o?o.length:0)};return e.jsx(O.Fragment,{children:o&&o.length>0?e.jsxs(O.Fragment,{children:[e.jsxs("div",{className:"flex-wrap i-flex-center s-8 mb-12",children:[e.jsx(ve,{items:o,onDragEnd:j,mode:"horizontal",children:o&&o.map((E,q)=>e.jsx(Ps,{isActive:u===q,onClick:x,boxIndex:i,boxId:t,fieldIndex:q,field:E,parentFieldIndex:n,parentFieldId:r,parentBlockId:l},E.id))}),e.jsx(Y,{type:"button",style:V.SECONDARY,size:"sm",onClick:E=>{E.preventDefault(),C()},children:"+"})]}),e.jsx("div",{children:o&&o.map((E,q)=>e.jsx(O.Fragment,{children:q===u&&e.jsx("div",{className:"with-border b-rounded",children:e.jsx(is,{setActiveTab:c,fieldIndex:q,field:E,view:"tabular",boxIndex:i,boxId:t,parentFieldIndex:n,parentFieldId:r,parentBlockId:l})})}))})]}):e.jsxs(O.Fragment,{children:[e.jsx(me,{style:V.WARNING,children:s('No field box already created. Create the first one now by clicking the button "Add field box"!')}),d&&e.jsx("a",{className:"acpt-btn acpt-btn-secondary acpt-btn-sm mt-24",href:"#",onClick:E=>{E.preventDefault(),C()},children:s("Add field box")})]})})};_e.propTypes={boxIndex:a.number.isRequired,boxId:a.string.isRequired,fields:a.array.isRequired,parentFieldIndex:a.string,parentFieldId:a.string,parentBlockId:a.string,addFieldEnabled:a.bool};const Us=({view:i,boxId:t,boxIndex:o,parentFieldIndex:n,parentFieldId:r,childrenFields:l,nestingLevel:d})=>{const v=d<We.MAX_NESTING;return e.jsx("div",{className:`mt-24 ${i==="accordion"?"with-border b-rounded":""}`,children:i==="list"||i==="accordion"?e.jsx(Ge,{addFieldEnabled:v,boxIndex:o,boxId:t,parentFieldIndex:n,parentFieldId:r,fields:l,view:i}):e.jsx(_e,{addFieldEnabled:v,boxIndex:o,boxId:t,parentFieldIndex:n,parentFieldId:r,fields:l})})};Us.propTypes={view:a.oneOf(["list","accordion","tabular"]).isRequired,boxId:a.string.isRequired,parentFieldId:a.string.isRequired,boxIndex:a.number.isRequired,parentFieldIndex:a.number.isRequired,childrenFields:a.array.isRequired,nestingLevel:a.number.isRequired};const Ks=({boxId:i,parentFieldId:t,blockId:o,blockIndex:n,setActiveTab:r})=>{const l=W(),{group:d}=K(u=>u.metaState),v=()=>X(d.boxes,i,o,!1),[b,m]=k.useState(!1),{control:h}=G(),{remove:T}=ne({control:h,name:v()}),y=[e.jsx(Y,{style:V.SUCCESS,onClick:u=>{u.preventDefault(),l(vs({boxId:i,parentFieldId:t,blockId:o})),T(n),m(!b),r&&r(0)},children:s("Yes")}),e.jsx(Y,{style:V.DANGER,onClick:u=>{u.preventDefault(),m(!b)},children:s("No")})];return e.jsxs(O.Fragment,{children:[e.jsx(ce,{title:s("Confirm deleting block"),visible:b,buttons:y,children:s("Are you sure?")}),e.jsx("a",{href:"#",onClick:u=>{u.preventDefault(),m(!b)},children:e.jsx(U,{icon:"bx-trash",width:18})})]})};Ks.propTypes={setActiveTab:a.func,boxId:a.string.isRequired,parentFieldId:a.string.isRequired,blockId:a.string.isRequired};const Hs=({block:i})=>{const o=document.globals.globals,{setValue:n}=G(),r=W(),{id:l}=pe(),[d,v]=k.useState(!1),[b,m]=k.useState(null),[h,T]=k.useState([]),[y,u]=k.useState([]),[c,x]=k.useState(null),[j,C]=k.useState(!1);k.useEffect(()=>{m(null),T([]),u([]),x(null),C(!1)},[d]);const E=f=>{m(f),T([]),u([]),x(null),C(!1),re("fetchMetaAction",{id:f}).then(p=>{T(p.boxes)}).catch(p=>console.error(p))},q=f=>{u([]);const p=h.filter(S=>S.id===f)[0].fields;u(p)},I=f=>{x(f)},g=()=>{re("copyMetaBlockAction",{blockId:i.id,targetFieldId:c,delete:j}).then(f=>{f.success?(de.success(`${s("Meta block was successfully copied")}.`),v(!d),l===i.groupId&&(console.log("fire"),r(Ne({id:l})).then(p=>{r(ge(p.payload)),n("id",l),n("name",p.payload.name),n("label",p.payload.label),n("display",p.payload.display),p.payload.belongs&&p.payload.belongs.map((S,A)=>{n(`belongs.${A}.id`,S.id),n(`belongs.${A}.belongsTo`,S.belongsTo),n(`belongs.${A}.operator`,S.operator),n(`belongs.${A}.find`,S.find),n(`belongs.${A}.logic`,S.logic)}),p.payload.boxes&&p.payload.boxes.map((S,A)=>{n(`boxes.${A}`,S)})}).catch(p=>{console.error(p)}))):de.error(f.error)}).catch(f=>console.error(f))};return e.jsxs(O.Fragment,{children:[e.jsx(ce,{title:s("Copy this meta block"),visible:d,buttons:[],children:e.jsxs("div",{className:"flex-column s-24",children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label i-flex-center s-4",htmlFor:"group",children:s("Meta group")}),e.jsx("div",{className:"acpt-select",children:e.jsx("select",{id:"group",className:"form-control default",onChangeCapture:f=>E(f.target.value),children:o.find.meta.map(f=>e.jsx("option",{value:f.value,children:f.label}))})})]}),h&&h.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"form-label i-flex-center s-4",htmlFor:"box",children:s("Meta box")}),e.jsx("div",{className:"acpt-select",children:e.jsxs("select",{id:"box",className:"form-control default",onChangeCapture:f=>q(f.target.value),children:[e.jsx("option",{value:null,children:s("Select")}),h.map(f=>e.jsx("option",{value:f.id,children:f.name}))]})})]}),y&&y.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"form-label i-flex-center s-4",htmlFor:"field",children:s("Meta field")}),e.jsx("div",{className:"acpt-select",children:e.jsxs("select",{id:"field",className:"form-control default",onChangeCapture:f=>I(f.target.value),children:[e.jsx("option",{value:null,children:s("Select")}),y.map(f=>e.jsx("option",{value:f.id,children:f.name}))]})})]}),c&&e.jsxs("div",{children:[e.jsxs("div",{className:"w-100 i-flex-center s-4 mb-8",children:[e.jsx("input",{type:"checkbox",defaultValue:j,onClick:()=>C(!j),id:"deleteBlock"}),e.jsx("label",{htmlFor:"deleteBlock",children:s("Delete the meta block after copying")})]}),e.jsx(Y,{onClick:()=>g(),style:V.PRIMARY,children:s("Copy")})]})]})}),e.jsx("a",{href:"#",onClick:f=>{f.preventDefault(),v(!d)},children:e.jsx(U,{icon:"bx:copy",width:18})})]})};Hs.propTypes={block:a.object.isRequired};const Ys=({boxId:i,block:t,view:o,listeners:n,attributes:r,formId:l,boxIndex:d,blockIndex:v,parentFieldIndex:b,parentFieldId:m,setActiveTab:h})=>{const{group:T,closedElements:y,selectedElementsType:u}=K(H=>H.metaState),{formState:{errors:c},register:x,control:j,resetField:C,setValue:E}=G(),q=M({control:j,name:X(T.boxes,i,t.id)}),I=M({control:j,name:l("name")}),g=M({control:j,name:l("label")}),[f,p]=k.useState(!0),S=()=>y.filter($=>$===t.id).length===1,A=()=>{const H=l("name"),$=ts(c,H);return $?e.jsx("span",{className:"invalid-feedback",children:s($.message)}):I||t.name},F=()=>g||t.label,R=W(),[N,D]=k.useState(!1),L=()=>{Qe(t.id),S()?R(Ze({id:t.id})):R(es({id:t.id}))},le=()=>!(typeof t.isSaved<"u"&&t.isSaved===!1),ue=()=>{let H="flex-between s-8 for-xs";return o==="accordion"&&(H=H+" p-24 bg-pale-gray",S()||(H=H+" b-bottom-1")),H};return e.jsxs("div",{className:ue(),children:[e.jsx(he,{id:l("id"),value:t.id,register:x}),e.jsxs("span",{className:"i-flex-center s-8",children:[o==="list"&&e.jsx("span",{className:"cursor-move top-2 handle",...r,...n,children:e.jsx(U,{icon:"bx:dots-vertical-rounded",color:"#777",width:18})}),u!=="box"&&u!=="field"&&le()&&e.jsx(Se,{elementType:"block",element:{id:t.id,boxId:i,parentFieldId:m}}),e.jsx("h3",{className:`${N?"hidden":""}`,children:A()}),e.jsx("span",{className:`top-1 color-gray ${N?"hidden":""}`,children:F()}),e.jsxs("div",{className:`i-flex-center s-8 ${N?"":"hidden"}`,children:[e.jsx("div",{children:e.jsx(Z,{size:"sm",id:l("label"),placeholder:s("Block label, non latin chars allowed."),defaultValue:t.label,register:x,errors:c,onChangeCapture:H=>{f&&E(l("name"),Ie(Ae(H.target.value)))},onClick:H=>{H.target.value==="new-block"&&C(l("label"))},validate:{maxLength:{value:255,message:"max length is 255"}}})}),e.jsx("div",{children:e.jsx(Z,{size:"sm",id:l("name"),placeholder:s("Block name. Allowed chars: [a-z0-9_-]"),defaultValue:t.name,register:x,errors:c,required:!0,onClick:H=>{H.target.value==="new_block"&&C(l("name"))},validate:{validate:$e,required:s("This field is mandatory"),maxLength:{value:255,message:"max length is 255"}}})}),e.jsx(P,{label:e.jsx("span",{className:`acpt-btn-switch ${f===!0?"active":""}`,onClick:H=>{H.preventDefault(),p(!f)},children:e.jsx(U,{icon:"bx-link",width:18})}),tip:s(`${f?"Auto slug ON":"Auto slug OFF"}`),icon:!1})]}),e.jsx(Y,{style:V.SECONDARY,size:"sm",onClick:H=>{H.preventDefault(),D(!N)},children:s(`${N?"Close":"Edit"}`)})]}),e.jsxs("span",{className:"i-flex-center s-8",children:[e.jsx(P,{label:e.jsx("a",{href:"#",onClick:H=>{H.preventDefault();const $=js(i,m,q);R(Ve({boxId:i,parentFieldId:m,block:$})),De(1).then(()=>{ye($.id)})},children:e.jsx(U,{icon:"bx:duplicate",width:18})}),tip:s("Duplicate this block"),icon:!1}),le()&&e.jsx(P,{label:e.jsx(Hs,{block:t}),tip:s("Copy this meta block"),icon:!1}),e.jsx(P,{label:e.jsx(Ks,{boxId:i,blockId:t.id,blockIndex:v,parentFieldId:m,setActiveTab:h}),tip:s("Delete this block"),icon:!1}),(o==="list"||o==="accordion")&&e.jsx(P,{label:e.jsx("a",{href:"#",onClick:H=>{H.preventDefault(),L()},children:e.jsx(U,{icon:"bx:expand-alt",width:18})}),tip:s("Hide/show this block"),icon:!1})]})]})};Ys.propTypes={boxIndex:a.number.isRequired,blockIndex:a.number.isRequired,formId:a.func.isRequired,boxId:a.string.isRequired,parentFieldIndex:a.string,parentFieldId:a.string,block:a.object.isRequired,view:a.oneOf(["list","tabular"]).isRequired,attributes:a.object,listeners:a.object,setActiveTab:a.func};const ns=({setActiveTab:i,blockIndex:t,block:o,view:n,boxIndex:r,boxId:l,parentFieldIndex:d,parentFieldId:v})=>{const{attributes:b,listeners:m,setNodeRef:h,transform:T}=Te({id:o.id}),y={transform:Ce.Translate.toString(T)},{group:u,closedElements:c}=K(g=>g.metaState),x=()=>c.filter(f=>f===o.id).length===1,j=g=>`${X(u.boxes,l,o.id)}.${g}`,E=0<We.MAX_NESTING,q=()=>{let g="bg-white b-rounded";return n==="list"&&(g=g+" with-shadow p-24"),n==="tabular"&&(g=g+" p-24"),n==="accordion"&&(g=g+" b-bottom-1"),g},I=()=>x()?"hidden":n==="list"?"mt-24":"";return e.jsxs("div",{id:o.id,className:q(),ref:n==="list"||n==="accordion"?h:null,style:n==="list"||n==="accordion"?y:null,children:[e.jsx(Ys,{formId:j,boxIndex:r,setActiveTab:i,attributes:n==="list"||n==="accordion"?b:null,listeners:n==="list"||n==="accordion"?m:null,view:n,boxId:l,block:o,blockIndex:t,parentFieldId:v}),n==="list"||n==="accordion"?e.jsx("div",{className:I(),children:e.jsx(Ge,{addFieldEnabled:E,boxIndex:r,boxId:l,parentFieldIndex:d,parentFieldId:v,parentBlockId:o.id,fields:o.fields,view:n})}):e.jsx("div",{className:"mt-24",children:e.jsx(_e,{addFieldEnabled:E,boxIndex:r,boxId:l,parentFieldIndex:d,parentFieldId:v,parentBlockId:o.id,fields:o.fields})})]})};ns.propTypes={view:a.oneOf(["list","tabular"]).isRequired,blockIndex:a.number.isRequired,block:a.object.isRequired,boxId:a.string.isRequired,boxIndex:a.string.isRequired,parentFieldIndex:a.number.isRequired,parentFieldId:a.string.isRequired,setActiveTab:a.func};const zs=({boxIndex:i,boxId:t,blocks:o,parentFieldIndex:n,parentFieldId:r,addBlockEnabled:l=!0,view:d})=>{const v=W(),{group:b}=K(c=>c.metaState),[m]=xe(),{control:h}=G(),{move:T}=ne({control:h,name:`${X(b.boxes,t,r)}.blocks`}),y=c=>{const{active:x,over:j}=c;if(x.id===j.id)return;const C=o.findIndex(I=>I.id===x.id),E=o.findIndex(I=>I.id===j.id),q=Re(o,C,E);T(C,E),v(ys({boxId:t,parentFieldId:r,sortedBlocks:q}))},u=()=>{const c={id:oe(),boxId:t,fieldId:r,label:"new-block",name:"new_block",fields:[],isSaved:!1};v(Ve({boxId:t,parentFieldId:r,block:c}))};return e.jsxs(O.Fragment,{children:[e.jsx("div",{className:o&&o.length>0&&d==="list"?"bg-pale-gray b-rounded p-24 flex-column s-24":"",ref:m,children:o&&o.length>0?e.jsx(ve,{onDragEnd:y,items:o,children:o.map((c,x)=>e.jsx(ns,{parentFieldId:r,boxIndex:i,parentFieldIndex:n,blockIndex:x,view:d,boxId:t,block:c}))}):e.jsx("div",{style:d==="accordion"?{padding:"24px 24px 0"}:{},children:e.jsx(me,{style:V.WARNING,children:s('No blocks already created. Create the first one now by clicking the button "Add block"!')})})}),l&&e.jsx("div",{className:d==="accordion"?"p-24":"",children:e.jsx("a",{className:`acpt-btn acpt-btn-secondary acpt-btn-sm ${d!=="accordion"?"mt-24":""}`,href:"#",onClick:c=>{c.preventDefault(),u()},children:s("Add block")})})]})};zs.propTypes={boxIndex:a.number.isRequired,boxId:a.string.isRequired,blocks:a.array.isRequired,parentFieldIndex:a.string,parentFieldId:a.string,addBlockEnabled:a.bool};const Ws=({isActive:i,onClick:t,boxIndex:o,blockIndex:n,boxId:r,block:l,parentFieldIndex:d,parentFieldId:v})=>{const{group:b,selectedElementsType:m}=K(q=>q.metaState),{control:h}=G(),y=M({control:h,name:(q=>`${X(b.boxes,r,l.id)}.${q}`)("name")}),{attributes:u,listeners:c,setNodeRef:x,transform:j}=Te({id:l.id}),C={transform:Ce.Translate.toString(j)},E=()=>!(typeof l.isSaved<"u"&&l.isSaved===!1);return e.jsx(O.Fragment,{children:e.jsx("div",{className:`acpt-btn-switch ${i?"active":""}`,ref:x,style:C,onClick:()=>{t(n)},children:e.jsxs("div",{className:"i-flex-center s-8",children:[e.jsx("span",{className:"cursor-move top-2 handle",...u,...c,onMouseDownCapture:()=>{t(n)},children:e.jsx(U,{icon:"bx:dots-vertical-rounded",color:"#777",width:18})}),m!=="box"&&m!=="field"&&E()&&e.jsx(Se,{elementType:"block",element:{id:l.id,boxId:r,parentFieldId:v}}),e.jsx("span",{className:"text-ellipsis",style:{maxWidth:"200px"},children:y||l.name}),e.jsx(we,{style:i?V.SECONDARY:V.DISABLED,children:l.fields?l.fields.length:0})]})})})};Ws.propTypes={boxIndex:a.number.isRequired,boxId:a.string.isRequired,blockIndex:a.string.isRequired,block:a.object.isRequired,parentFieldIndex:a.string,parentFieldId:a.string,isActive:a.bool.isRequired,onClick:a.func.isRequired};const Xs=({boxIndex:i,boxId:t,blocks:o,parentFieldIndex:n,parentFieldId:r,addBlockEnabled:l=!0})=>{const d=W(),{group:v}=K(x=>x.metaState),{control:b}=G(),{move:m}=ne({control:b,name:`${X(v.boxes,t,r)}.blocks`}),[h,T]=k.useState(0);k.useEffect(()=>{o[h]||T(0)},[o]);const y=x=>{T(x)},u=x=>{const{active:j,over:C}=x;if(j.id===C.id)return;const E=o.findIndex(g=>g.id===j.id),q=o.findIndex(g=>g.id===C.id),I=Re(o,E,q);m(E,q),T(q),d(ys({boxId:t,parentFieldId:r,sortedBlocks:I}))},c=()=>{const x={id:oe(),boxId:t,fieldId:r,label:"new-block",name:"new_block",fields:[],isSaved:!1};d(Ve({boxId:t,parentFieldId:r,block:x}))};return e.jsx(O.Fragment,{children:o&&o.length>0?e.jsxs(O.Fragment,{children:[e.jsxs("div",{className:"flex-wrap i-flex-center s-8 mb-12",children:[e.jsx(ve,{items:o,onDragEnd:u,mode:"horizontal",children:o&&o.map((x,j)=>e.jsx(Ws,{isActive:h===j,onClick:y,boxIndex:i,boxId:t,blockIndex:j,block:x,parentFieldIndex:n,parentFieldId:r},x.id))}),e.jsx(Y,{type:"button",style:V.SECONDARY,size:"sm",onClick:x=>{x.preventDefault(),c()},children:"+"})]}),e.jsx("div",{children:o&&o.map((x,j)=>e.jsx(O.Fragment,{children:j===h&&e.jsx("div",{className:"b-rounded with-border",children:e.jsx(ns,{setActiveTab:T,blockIndex:j,block:x,view:"tabular",boxIndex:i,boxId:t,parentFieldIndex:n,parentFieldId:r})})}))})]}):e.jsxs(O.Fragment,{children:[e.jsx(me,{style:V.WARNING,children:s('No blocks already created. Create the first one now by clicking the button "Add block"!')}),l&&e.jsx("a",{className:"acpt-btn acpt-btn-secondary acpt-btn-sm mt-24",href:"#",onClick:x=>{x.preventDefault(),c()},children:s("Add block")})]})})};Xs.propTypes={boxIndex:a.number.isRequired,boxId:a.string.isRequired,blocks:a.array.isRequired,parentFieldIndex:a.string,parentFieldId:a.string,addBlockEnabled:a.bool};const Js=({view:i,boxId:t,boxIndex:o,parentFieldIndex:n,parentFieldId:r,blocks:l,nestingLevel:d})=>{const v=d<We.MAX_NESTING;return e.jsx("div",{className:`mt-24 ${i==="accordion"?"with-border b-rounded":""}`,children:i==="list"||i==="accordion"?e.jsx(zs,{addBlockEnabled:v,boxIndex:o,boxId:t,parentFieldIndex:n,parentFieldId:r,blocks:l,view:i}):e.jsx(Xs,{addBlockEnabled:v,boxIndex:o,boxId:t,parentFieldIndex:n,parentFieldId:r,blocks:l})})};Js.propTypes={view:a.oneOf(["list","accordion","tabular"]).isRequired,boxId:a.string.isRequired,parentFieldId:a.string.isRequired,boxIndex:a.number.isRequired,parentFieldIndex:a.number.isRequired,blocks:a.array.isRequired,nestingLevel:a.number.isRequired};const Qs="OneToOneUni",Zs="OneToOneBi",el="OneToManyUni",sl="OneToManyBi",ll="ManyToOneUni",tl="ManyToOneBi",al="ManyToManyUni",nl="ManyToManyBi",dt=[{value:null,label:s("Select")},{value:Qs,label:s("One to One - Unidirectional")},{value:Zs,label:s("One to One - Bidirectional")},{value:el,label:s("One to Many - Unidirectional")},{value:sl,label:s("One to Many - Bidirectional")},{value:ll,label:s("Many to One - Unidirectional")},{value:tl,label:s("Many to One - Bidirectional")},{value:al,label:s("Many to Many - Unidirectional")},{value:nl,label:s("Many to Many - Bidirectional")}],ct=[{value:null,label:s("Select")},{value:Qs,label:s("One to One - Unidirectional")},{value:el,label:s("One to Many - Unidirectional")},{value:ll,label:s("Many to One - Unidirectional")},{value:al,label:s("Many to Many - Unidirectional")}],hs=i=>i===Zs||i===sl||i===tl||i===nl,il=({field:i,formId:t})=>{const r=document.globals.globals.find,l=i.relations&&i.relations.length>0?i.relations[0]:null,{control:d,register:v,resetField:b,setValue:m,formState:{errors:h}}=G(),T=M({control:d,name:t("relations.0.relationship")}),y=M({control:d,name:"id"}),[u,c]=k.useState([]),[x,j]=k.useState([]),[C,E]=k.useState([]);k.useEffect(()=>{re("fetchMetaAction",{excludeField:i.id}).then(p=>{let S=[],A=[{label:s("Select"),value:null}];p.records&&p.records.length>0&&p.records.filter(F=>F.id!==y).map(F=>{let R=[];F.boxes.map(N=>{S.push(N),R.push({label:N.UIName+" ("+F.name+")",value:N.id})}),R&&R.length>0&&A.push({label:F.name,options:R})}),c(S),j(A),l&&l.inversedBoxId&&g(l.inversedBoxId,S)}).catch(p=>console.error(p))},[]);const q=p=>{hs(p)||(b(t("relations.0.inversedBoxId")),b(t("relations.0.inversedFieldId")),E([]),j([]))},I=(p,S)=>{m(t(`relations.0.${p}.type`),S),b(t("relations.0.relationship")),b(t("relations.0.inversedBoxId")),b(t("relations.0.inversedFieldId"))},g=(p,S)=>{let A=[{label:s("Select"),value:null}];const F=S.filter(R=>R.id===p);F&&F.length===1&&F[0].fields.map(R=>{A.push({label:R.name,value:R.id}),R.blocks&&R.blocks.length>0&&R.blocks.map(N=>{N.fields&&N.fields.length>0&&N.fields.map(D=>{A.push({label:D.name,value:D.id}),D.blocks&&D.blocks.length>0&&D.blocks.map(L=>{L.fields&&L.fields.length>0&&L.fields.map(le=>{A.push({label:le.name,value:le.id})})})})}),R.children&&R.children.length>0&&R.children.map(N=>{A.push({label:N.name,value:N.id}),N.children&&N.children.length>0&&N.children.map(D=>{A.push({label:D.name,value:D.id})})})}),E(A)};if(Q(r))return null;const f=()=>{let p=[{label:s("Select"),value:null}];const S=r[J.CUSTOM_POST_TYPE].filter(F=>F.value!==null),A=r[J.TAXONOMY].filter(F=>F.value!==null);return S&&S.length>0&&p.push({label:s("Custom post types"),originalLabel:J.CUSTOM_POST_TYPE,options:S}),A&&A.length>0&&p.push({label:s("Taxonomies"),originalLabel:J.TAXONOMY,options:A}),p.push({label:s("Option pages"),originalLabel:J.OPTION_PAGE,options:[{label:s("All pages"),value:J.OPTION_PAGE}]}),p.push({label:s("Users"),originalLabel:J.USER,options:[{label:s("All users"),value:J.USER}]}),p};return e.jsxs("div",{className:"mt-24",children:[e.jsx(he,{id:t("relations.0.relatedEntity.type"),value:i.type,register:v}),e.jsxs("fieldset",{className:"acpt-fieldset",children:[e.jsx("legend",{children:s("Related entities and relationship")}),e.jsxs("div",{className:"flex-column s-24",children:[e.jsxs("div",{className:"container align-end",children:[e.jsxs("div",{className:"col-4",children:[e.jsx("div",{className:"mb-8",children:e.jsx(P,{label:e.jsx("label",{className:"form-label",htmlFor:t("relations.0.from.value"),children:s("From")}),tip:s("The first entity involved in the relationship")})}),e.jsx(se,{register:v,id:t("relations.0.from.value"),errors:h,values:f(),onChangeCapture:p=>{I("from",p.target.selectedOptions[0].parentElement.dataset.original)},validate:{required:s("This field is mandatory")}})]}),e.jsxs("div",{className:"col-4",children:[e.jsx("div",{className:"mb-8",children:e.jsx(P,{label:e.jsx("label",{className:"form-label",htmlFor:t("relations.0.to.value"),children:s("To")}),tip:s("The second entity involved in the relationship")})}),e.jsx(se,{register:v,id:t("relations.0.to.value"),errors:h,values:f(),onChangeCapture:p=>{I("to",p.target.selectedOptions[0].parentElement.dataset.original)},validate:{required:s("This field is mandatory")}})]}),e.jsxs("div",{className:"col-4",children:[e.jsx("div",{className:"mb-8",children:e.jsx(P,{label:e.jsx("label",{className:"form-label",htmlFor:t("relations.0.relationship"),children:s("Relationship")}),tip:s("The relationship between the selected entities")})}),e.jsx(se,{register:v,id:t("relations.0.relationship"),errors:h,values:i.parentId?ct:dt,onChangeCapture:p=>{q(p.target.value)},validate:{required:s("This field is mandatory")}})]})]}),hs(T)&&e.jsxs("div",{className:"container align-end",children:[e.jsxs("div",{className:"col-6",children:[e.jsx("div",{className:"mb-8",children:e.jsx(P,{label:e.jsxs("label",{className:"form-label",htmlFor:t("relations.0.inversedBoxId"),children:[s("Target field"),". ",s("Select field box from list")]}),tip:s("The inversed field is the target post type field which is related with this one in a bidirectional relation")})}),e.jsx(se,{register:v,id:t("relations.0.inversedBoxId"),errors:h,values:x,defaultValue:l&&l.inversedBoxId?l.inversedBoxId:null,onChangeCapture:p=>{g(p.target.value,u)},validate:{required:s("This field is mandatory")}})]}),e.jsxs("div",{className:"col-6",children:[e.jsx("div",{className:"mb-8",children:e.jsx(P,{label:e.jsxs("label",{className:"form-label",htmlFor:t("relations.0.inversedFieldId"),children:[s("Target field"),". ",s("Select the inversed field on target")]}),tip:s("The inversed field is the target post type field which is related with this one in a bidirectional relation")})}),e.jsx(se,{register:v,id:t("relations.0.inversedFieldId"),errors:h,values:C,defaultValue:l&&l.inversedFieldId?l.inversedFieldId:null,validate:{required:s("This field is mandatory")}})]})]})]})]})]})};il.propTypes={formId:a.func.isRequired,field:a.object.isRequired};const ol=({view:i,formId:t,boxIndex:o,fieldIndex:n,boxId:r,field:l})=>{const{group:d}=K(R=>R.metaState),v=W(),[b,m]=k.useState(!0),{register:h,unregister:T,control:y,formState:{errors:u},resetField:c,reset:x,setValue:j,setError:C,clearErrors:E}=G(),q=M({control:y,name:t("type")}),I=M({control:y,name:`boxes.${o}.fields`}),g=M({control:y,name:`boxes.${o}.name`}),f=wl(d.boxes,r,l.id),p=()=>q||l.type,S=R=>{if(p()!==R){const N={...l};N.type=R,R!==w.REPEATER&&(N.children=[]),R!==w.FLEXIBLE&&(N.blocks=[]),R!==w.POST&&(N.relations=[]),Dl(R)||(T(t("relations")),T(t("visibilityConditions")),T(t("validationRules")),N.visibilityConditions=[],N.validationRules=[],N.relations=[]),T(t("relations")),T(t("blocks")),T(t("children")),v(Bl({field:N,boxId:r}))}},A=async R=>{if(b){const N=Ie(Ae(R));j(t("name"),N),await F(N)?C(t("name"),{message:s("Name is already taken")}):E(t("name"))}},F=async R=>{const N=Ie(Ae(R));let D=[];if(I.map((L,le)=>{le!==n&&D.push(L.name)}),D.includes(N))return s("Name is already taken");if(l.name!==N&&(await re("checkMetaBoxFieldNameAction",{boxName:g||l.boxName,fieldName:N})).exists===!0)return s("Name is already taken")};return e.jsxs(O.Fragment,{children:[e.jsxs("div",{className:"flex-column s-24",children:[e.jsxs("div",{className:"container align-end",children:[e.jsxs("div",{className:"col-4",children:[e.jsx(fe,{isRequired:!1,id:t("label"),label:e.jsxs("div",{className:"flex-between",children:[e.jsx("span",{children:s("Field label")}),e.jsx("a",{href:"#",onClick:R=>{R.preventDefault(),m(!b)},children:s(`${b?"Auto slug ON":"Auto slug OFF"}`)})]})}),e.jsx(Z,{id:t("label"),register:h,errors:u,defaultValue:l.label,placeholder:s("The field label, non latin characters are allowed"),onChangeCapture:Os(R=>{A(R.target.value)},300),onClick:R=>{R.target.value==="meta box field"&&c(t("label"))},validate:{maxLength:{value:255,message:"max length is 255"}}})]}),e.jsxs("div",{className:"col-4",children:[e.jsx(fe,{isRequired:!0,id:t("name"),label:s("Field slug")}),e.jsx(Z,{id:t("name"),register:h,errors:u,placeholder:s("Field slug (Ex. gallery or text_1)"),defaultValue:l.name,onClick:R=>{R.target.value==="meta_box_field"&&c(t("name"))},validate:{validate:{alphanumericallyValid:$e,checkIfNameIsValid:F},required:s("This field is mandatory"),maxLength:{value:255,message:"max length is 255"}}})]}),e.jsxs("div",{className:"col-4",children:[e.jsx(fe,{isRequired:!0,id:t("type"),label:s("Choose the field type")}),e.jsx(se,{register:h,id:t("type"),errors:u,defaultValue:l.type,values:Cl(f),onChangeCapture:R=>{S(R.target.value)}})]})]}),e.jsxs("div",{className:"container align-end",children:[e.jsxs("div",{className:"col-6",children:[e.jsx(fe,{id:t("defaultValue"),label:s("The default value for this field")}),e.jsx(Z,{id:t("defaultValue"),register:h,errors:u,placeholder:s("Default value"),defaultValue:l.defaultValue,validate:{maxLength:{value:255,message:"max length is 255"}}})]}),e.jsxs("div",{className:"col-6",children:[e.jsx(fe,{id:t("description"),label:s("The description of this field (showed only on admin panel)")}),e.jsx(Z,{id:t("description"),register:h,errors:u,placeholder:s("A brief description"),defaultValue:l.description,validate:{maxLength:{value:255,message:"max length is 255"}}})]})]})]}),Rl(p())&&e.jsx(Gs,{boxId:r,fieldId:l.id,boxIndex:o,fieldIndex:n,parentFieldId:l.parentId?l.parentId:null,options:l.options?l.options:[],isMulti:l.type===w.SELECT_MULTI||l.type===w.CHECKBOX}),Sl(p())&&e.jsx(Us,{nestingLevel:f,view:i,boxId:r,parentFieldId:l.id,boxIndex:o,parentFieldIndex:n,childrenFields:l.children}),El(p())&&e.jsx(Js,{nestingLevel:f,view:i,boxId:r,parentFieldId:l.id,boxIndex:o,parentFieldIndex:n,blocks:l.blocks}),ql(p())&&e.jsx(il,{formId:t,field:l})]})};ol.propTypes={view:a.oneOf(["list","tabular"]).isRequired,formId:a.func.isRequired,boxIndex:a.number.isRequired,fieldIndex:a.number.isRequired,boxId:a.string.isRequired,field:a.object.isRequired};const rl=({field:i,formId:t})=>{const{control:o,register:n,formState:{errors:r},setValue:l,clearErrors:d}=G(),v=M({control:o,name:t("children")}),b=M({control:o,name:t("blocks")}),m=[{label:s("On the top"),value:"top"},{label:s("On the left"),value:"left"},{label:s("On the right"),value:"right"},{label:s("No display"),value:"none"}],h=[{label:s("Row"),value:"row"},{label:s("Block"),value:"block"},{label:s("Table"),value:"table"}],T=[{label:s("Select"),value:null},{label:s("Yes"),value:"1"},{label:s("No"),value:"0"}];let y=[];v&&v.length>0&&v.map(c=>{Me(c.type)&&y.push({label:c.label?c.label:c.name,value:c.id})}),b&&b.length>0&&b.map(c=>{c.fields&&c.fields.length>0&&c.fields.map(x=>{Me(x.type)&&y.push({label:x.label?x.label:x.name,value:x.id})})});const u=({type:c,index:x,innerKey:j,label:C,placeholder:E,options:q})=>{const I=p=>`${t(`advancedOptions.${x}.${p}`)}`,g=()=>{if(!i.advancedOptions)return null;const p=i.advancedOptions[x];return p||null},f=()=>{let p={};return q.min&&(p.min={value:q.min,message:s("min length is")+" "+q.min}),q.max&&(p.max={value:q.max,message:s("max length is")+" "+q.max}),p};return e.jsxs(O.Fragment,{children:[e.jsx(he,{id:I("id"),value:g()?g().id:oe(),register:n}),e.jsx(he,{id:I("key"),value:g()?g().key:j,register:n}),e.jsx(fe,{id:I("value"),label:e.jsx("span",{dangerouslySetInnerHTML:{__html:C}})}),c==="integer"&&e.jsx(Z,{type:"number",id:I("value"),register:n,errors:r,placeholder:E,min:q.min?q.min:null,max:q.max?q.max:null,step:q.step?q.step:null,defaultValue:g()?g().value:null,validate:f()}),c==="select"&&q&&q.options&&e.jsx(O.Fragment,{children:q.multiple&&q.multiple===!0?e.jsx(Fe,{clearErrors:d,errors:r,id:I("value"),register:n,setValue:l,values:q.options,defaultValue:g()?g().value:null}):e.jsx(se,{register:n,id:I("value"),errors:r,placeholder:E,values:q.options,defaultValue:g()?g().value:null})}),c==="text"&&e.jsx(Z,{id:I("value"),register:n,errors:r,placeholder:E,defaultValue:g()?g().value:null})]})};return e.jsxs("div",{className:"flex-column s-24",children:[e.jsxs("fieldset",{className:"acpt-fieldset",children:[e.jsx("legend",{children:s("General settings")}),e.jsxs("div",{className:"flex-column s-24",children:[e.jsxs("div",{className:"container align-end",children:[e.jsx("div",{className:"col-6",children:u({type:"select",index:1,innerKey:"headline",placeholder:s("Select the headline location (default: on the left)"),label:s("Headline location"),options:{options:m}})}),e.jsx("div",{className:"col-6",children:u({type:"integer",index:2,innerKey:"width",placeholder:s("Field width in % ([1-100] default value: 100)"),label:s("Field width"),options:{min:1,max:100,step:1}})})]}),e.jsxs("div",{className:"container align-end",children:[e.jsx("div",{className:"col-6",children:u({type:"text",index:6,innerKey:"before",placeholder:s("This text will appear before input"),label:s("Text before. HTML is allowed (ex. &lt;small&gt;)"),options:{}})}),e.jsx("div",{className:"col-6",children:u({type:"text",index:7,innerKey:"after",placeholder:s("This text will appear after input"),label:s("Text after. HTML is allowed (ex. &lt;small&gt;)"),options:{}})})]}),e.jsx("div",{className:"container align-end",children:e.jsx("div",{className:"col-12",children:u({type:"text",index:18,innerKey:"css",placeholder:s("These CSS classes will be applied to back-end editor fields"),label:s("Add CSS classes to back-end editor fields (ex. class-active pulse)"),options:{}})})})]})]}),Me(i.type)&&e.jsxs("fieldset",{className:"acpt-fieldset",children:[e.jsx("legend",{children:s("Textual fields settings")}),e.jsxs("div",{className:"flex-column s-24",children:[e.jsxs("div",{className:"container align-end",children:[e.jsx("div",{className:"col-6",children:u({type:"integer",index:8,innerKey:"min",placeholder:s("The minimum value (used only by numeric and textual fields)"),label:s("Min value (used only by numeric and textual fields)"),options:{}})}),e.jsx("div",{className:"col-6",children:u({type:"integer",index:9,innerKey:"max",placeholder:s("The maximum value (used only by numeric and textual fields)"),label:s("Max value (used only by numeric and textual fields)"),options:{}})})]}),e.jsxs("div",{className:"container align-end",children:[e.jsx("div",{className:"col-6",children:u({type:"integer",index:10,innerKey:"step",placeholder:s("Step value (used only by numeric fields)"),label:s("Step value (used only by numeric fields)"),options:{}})}),e.jsx("div",{className:"col-6",children:u({type:"text",index:11,innerKey:"pattern",placeholder:s("Pattern value (used only by numeric and textual fields)"),label:s("Pattern value (used only by textual fields)"),options:{}})})]})]})]}),Vl(i.type)&&e.jsxs("fieldset",{className:"acpt-fieldset",children:[e.jsx("legend",{children:s("File field settings")}),e.jsxs("div",{className:"flex-column s-24",children:[e.jsxs("div",{className:"container align-end",children:[e.jsx("div",{className:"col-6",children:u({type:"select",index:14,innerKey:"accepts",placeholder:s("Input file accepts"),label:s("Input file accepts"),options:{multiple:!0,options:[{label:"image",value:"image"},{label:"video",value:"video"},{label:"document",value:"document"},{label:"audio",value:"audio"}]}})}),e.jsx("div",{className:"col-6",children:u({type:"select",index:5,innerKey:"hide_url_label",placeholder:s("Hide the label"),label:s("Hide the label"),options:{options:T}})})]}),e.jsxs("div",{className:"container align-end",children:[e.jsx("div",{className:"col-6",children:u({type:"integer",index:16,innerKey:"max_size",placeholder:s("Maximum size"),label:`${s("Maximum size")} (Mb)`,options:{}})}),e.jsx("div",{className:"col-6",children:u({type:"integer",index:17,innerKey:"min_size",placeholder:s("Minimum size"),label:`${s("Minimum size")} (Mb)`,options:{}})})]})]})]}),$l(i.type)&&e.jsxs("fieldset",{className:"acpt-fieldset",children:[e.jsx("legend",{children:s("Radio field settings")}),e.jsx("div",{children:u({type:"select",index:4,innerKey:"hide_blank_radio",placeholder:s("Hide the blank value"),label:s("Hide the blank value"),options:{options:T}})})]}),Ll(i.type)&&e.jsxs("fieldset",{className:"acpt-fieldset",children:[e.jsx("legend",{children:s("URL field settings")}),e.jsx("div",{children:u({type:"select",index:5,innerKey:"hide_url_label",placeholder:s("Hide the label"),label:s("Hide the label"),options:{options:T}})})]}),_l(i.type)&&e.jsxs("fieldset",{className:"acpt-fieldset",children:[e.jsx("legend",{children:s("Nestable fields layout settings")}),e.jsxs("div",{className:"flex-column s-24",children:[e.jsxs("div",{className:"container align-end",children:[e.jsx("div",{className:"col-6",children:u({type:"select",index:19,innerKey:"leading_field",placeholder:s("The leading field (which will be displayed when the repeater is collapsed)."),label:s("Leading field"),options:{options:y}})}),e.jsx("div",{className:"col-6",children:u({type:"select",index:20,innerKey:"layout",placeholder:s("The look of the field for admins and editors."),label:s("Field layout"),options:{options:h}})})]}),e.jsxs("div",{className:"container align-end",children:[e.jsx("div",{className:"col-4",children:u({type:"integer",index:3,innerKey:"columns",placeholder:s("Field columns ([1-6] only for repeater field)"),label:s("Field columns"),options:{min:1,max:6,step:1}})}),e.jsx("div",{className:"col-4",children:u({type:"integer",index:12,innerKey:"minimum_blocks",placeholder:s("The limit on how many elements are required ([1-100] only for repeater field)"),label:s("Minimum elements allowed"),options:{}})}),e.jsx("div",{className:"col-4",children:u({type:"integer",index:13,innerKey:"maximum_blocks",placeholder:s("The limit on how many elements are allowed ([1-100] only for repeater field)"),label:s("Maximum elements allowed"),options:{}})})]})]})]}),Gl(i.type)&&e.jsxs("fieldset",{className:"acpt-fieldset",children:[e.jsx("legend",{children:s("Unit of measure fields settings")}),e.jsx("div",{children:u({type:"select",index:0,innerKey:"uom_default_value",placeholder:s("UOM default value"),label:s("UOM default value"),options:{options:document.globals.globals.uom[i.type.toLowerCase()]}})})]})]})};rl.propTypes={formId:a.func.isRequired,boxIndex:a.number.isRequired,fieldIndex:a.number.isRequired,field:a.object.isRequired};const dl=({boxId:i,fieldId:t,elementId:o,elementIndex:n,parentFieldId:r})=>{const l=W(),{group:d}=K(u=>u.metaState),v=()=>`${X(d.boxes,i,t)}.visibilityConditions`,{control:b}=G(),{remove:m}=ne({control:b,name:v()}),[h,T]=k.useState(!1),y=[e.jsx(Y,{style:V.SUCCESS,onClick:u=>{u.preventDefault(),l(Pl({boxId:i,fieldId:t,parentFieldId:r,elementId:o})),m(n),T(!h)},children:s("Yes")}),e.jsx(Y,{style:V.DANGER,onClick:u=>{u.preventDefault(),T(!h)},children:s("No")})];return e.jsxs("div",{children:[e.jsx(ce,{title:s("Confirm deleting conditional rendering element"),visible:h,buttons:y,children:s("Are you sure?")}),e.jsx("a",{href:"#",onClick:u=>{u.preventDefault(),T(!h)},children:e.jsx(P,{icon:!1,tip:s("Delete"),label:e.jsx(U,{icon:"bx-minus"})})})]})};dl.propTypes={boxId:a.string.isRequired,fieldId:a.string.isRequired,elementId:a.string.isRequired,elementIndex:a.number.isRequired,parentFieldId:a.string};const cl=({elementIndex:i,boxIndex:t,fieldIndex:o,boxId:n,fieldId:r,element:l,parentFieldIndex:d,parentFieldId:v,isLast:b})=>{const{POST_TAX:m,POST_ID:h}=document.globals.globals.find,{group:T}=K($=>$.metaState),y=$=>`${X(T.boxes,n,r)}.visibilityConditions.${i}.${$}`,{register:u,formState:{errors:c},control:x,setValue:j,clearErrors:C}=G(),E=M({control:x,name:"belongs"}),q=M({control:x,name:"boxes"}),I=M({control:x,name:`${X(T.boxes,n,r)}.type`}),g=M({control:x,name:y("type")}),f=M({control:x,name:y("operator")}),p=M({control:x,name:y("value")}),S=M({control:x,name:y("logic")}),A=M({control:x,name:y("frontEnd")}),F=M({control:x,name:y("backEnd")}),[R,N]=k.useState([]);k.useEffect(()=>{E&&E.map($=>{$.belongsTo===J.TAXONOMY&&re("fetchTermsAction",{taxonomy:$.find,format:"short"}).then(ee=>N([...R,...ee]))})},[E]);const D=()=>{const $=[w.NUMBER,w.TEXT,w.TEXTAREA,w.SELECT,w.SELECT_MULTI,w.DATE,w.DATE_TIME,w.TIME,w.URL,w.PHONE,w.EMAIL,w.COLOR,w.CURRENCY,w.WEIGHT,w.LENGTH,w.TOGGLE,w.POST,w.POST_OBJECT,w.POST_OBJECT_MULTI,w.TERM_OBJECT,w.TERM_OBJECT_MULTI,w.USER,w.USER_MULTI];let ee=[],B=[],_=[{value:null,label:s("Select")}];if(q.map(z=>{if(typeof z.fields<"u"&&z.fields.length>0){const te=Ul(z);te&&te.length>0&&te.filter(ae=>ae.field&&ae.field.id===r).map(ae=>{ae.fields&&ae.fields.map(ie=>{if($.includes(ie.type)&&ie.id!==r){const qe=()=>{let be="";return be+=`[${z.label?z.label:z.name}] `,be+=ie.label?ie.label:ie.name,be};B.push({label:qe(),value:Ee({type:"OTHER_FIELDS",value:ie.id})})}})})}}),$.includes(I)&&ee.push({value:Ee({type:"VALUE",value:"VALUE"}),label:s("Value")}),E&&E.map(z=>{z.belongsTo===J.CUSTOM_POST_TYPE&&ee.push({value:Ee({type:"POST_ID",value:"POST_ID"}),label:s("Post")}),z.belongsTo===J.TAXONOMY&&ee.push({value:Ee({type:"TERM_ID",value:"TERM_ID"}),label:s("Term")})}),ee&&ee.length>0&&$.includes(I)&&_.push({label:s("This field"),options:ee}),m&&m.length>0){let z={label:s("Related taxonomies"),options:[]};m.map(te=>{te.value!==null&&z.options.push({value:Ee({type:"TAXONOMY",value:te.label}),label:te.label})}),_.push(z)}return B&&B.length>0&&_.push({label:s("Other fields"),options:B}),_},L=()=>typeof g>"u",le=$=>{if(!g||typeof g>"u")return[{value:null,label:s("Select")}];const ee=typeof g=="object"?g:os(g),B=ee.type;return ee.value,B==="VALUE"?$===w.SELECT_MULTI?[{value:null,label:s("Select")},{value:"IN",label:s("is included in")},{value:"NOT_IN",label:s("is not included in")},{value:"BLANK",label:s("is empty")},{value:"NOT_BLANK",label:s("is not empty")}]:$===w.NUMBER||$===w.CURRENCY||$===w.WEIGHT||$===w.LENGTH||$===w.DATE||$===w.DATE_TIME||$===w.TIME?[{value:null,label:s("Select")},{value:"=",label:s("is equal to")},{value:"!=",label:s("is not equal to")},{value:"<",label:s("is less than")},{value:">",label:s("is greater than")},{value:"<=",label:s("is less than or equal to")},{value:">=",label:s("is greater than or equal to")},{value:"BLANK",label:s("is empty")},{value:"NOT_BLANK",label:s("is not empty")}]:$===w.TOGGLE?[{value:null,label:s("Select")},{value:"CHECKED",label:s("is checked")},{value:"NOT_CHECKED",label:s("is not checked")}]:[{value:null,label:s("Select")},{value:"=",label:s("is equal to")},{value:"!=",label:s("is not equal to")},{value:"LIKE",label:s("is like to")},{value:"NOT_LIKE",label:s("is not like")},{value:"BLANK",label:s("is empty")},{value:"NOT_BLANK",label:s("is not empty")}]:B==="OTHER_FIELDS"?$===w.SELECT_MULTI?[{value:null,label:s("Select")},{value:"IN",label:s("is included in")},{value:"NOT_IN",label:s("is not included in")},{value:"BLANK",label:s("is empty")},{value:"NOT_BLANK",label:s("is not empty")}]:$===w.NUMBER||$===w.CURRENCY||$===w.WEIGHT||$===w.LENGTH||$===w.DATE||$===w.TIME?[{value:null,label:s("Select")},{value:"=",label:s("is equal to")},{value:"!=",label:s("is not equal to")},{value:"<",label:s("is less than")},{value:">",label:s("is greater than")},{value:"<=",label:s("is less than or equal to")},{value:">=",label:s("is greater than or equal to")},{value:"BLANK",label:s("is empty")},{value:"NOT_BLANK",label:s("is not empty")}]:$===w.TOGGLE?[{value:null,label:s("Select")},{value:"CHECKED",label:s("is checked")},{value:"NOT_CHECKED",label:s("is not checked")}]:[{value:null,label:s("Select")},{value:"=",label:s("is equal to")},{value:"!=",label:s("is not equal to")},{value:"LIKE",label:s("is like to")},{value:"NOT_LIKE",label:s("is not like")},{value:"BLANK",label:s("is empty")},{value:"NOT_BLANK",label:s("is not empty")}]:B==="POST_ID"||B==="TERM_ID"?[{value:null,label:s("Select")},{value:"=",label:s("is equal to")},{value:"!=",label:s("is not equal to")},{value:"IN",label:s("is included in")},{value:"NOT_IN",label:s("is not included in")}]:B==="TAXONOMY"?[{value:null,label:s("Select")},{value:"IN",label:s("is included in")},{value:"NOT_IN",label:s("is not included in")},{value:"BLANK",label:s("is empty")},{value:"NOT_BLANK",label:s("is not empty")}]:[{value:null,label:s("Select")},{value:"=",label:s("is equal to")},{value:"!=",label:s("is not equal to")},{value:"IN",label:s("is included in")},{value:"NOT_IN",label:s("is not included in")},{value:"BLANK",label:s("is empty")},{value:"NOT_BLANK",label:s("is not empty")}]},ue=()=>g&&f&&f!=="BLANK"&&f!=="NOT_BLANK"&&f!=="CHECKED"&&f!=="NOT_CHECKED",H=()=>{let $=typeof g=="object"?g:os(g);typeof $=="string"&&($=JSON.parse($));const ee=$.type,B=$.value,_=f==="IN"||f==="NOT_IN",z=f==="CHECKED"||f==="NOT_CHECKED",te={value:null,label:s("Select")};if(ee==="POST_ID"){const ae=()=>{if(l.operator==="IN"||l.operator==="NOT_IN"){const ie=p||l.value,qe=typeof ie=="string"?ie.split(","):ie;let be=[];return qe.map(Ye=>be.push(parseInt(Ye))),be}return p||l.value};return console.log($),_?e.jsx(O.Fragment,{children:e.jsx(Fe,{id:y("value"),defaultValue:ae(),placeholder:s("Select posts"),values:h,errors:c,register:u,setValue:j,clearErrors:C,validate:{required:s("This field is mandatory")}})}):e.jsx(O.Fragment,{children:e.jsx(se,{id:y("value"),defaultValue:ae(),placeholder:s("Select posts"),values:[...te,...h],errors:c,register:u,validate:{required:s("This field is mandatory")}})})}if(ee==="TAXONOMY"){if(m&&m.length>0){const ae=m.filter(ie=>ie.label===B);if(ae&&ae.length===1)return _?e.jsx(O.Fragment,{children:e.jsx(Fe,{id:y("value"),defaultValue:p||l.value,placeholder:s("Select taxonomies"),errors:c,register:u,values:ae[0].options,setValue:j,clearErrors:C,validate:{required:s("This field is mandatory")}})}):e.jsx(O.Fragment,{children:e.jsx(se,{id:y("value"),defaultValue:p||l.value,placeholder:s("Select taxonomy"),errors:c,register:u,values:[...te,...ae[0].options],validate:{required:s("This field is mandatory")}})})}return e.jsx(O.Fragment,{children:e.jsx(Z,{id:y("value"),errors:c,register:u,defaultValue:p||l.value,placeholder:s("value"),validate:{required:s("This field is mandatory")}})})}if(ee==="TERM_ID"){const ae=()=>{if(l.operator==="IN"||l.operator==="NOT_IN"){const ie=p||l.value,qe=typeof ie=="string"?ie.split(","):ie;let be=[];return qe.map(Ye=>be.push(parseInt(Ye))),be}return p||l.value};return _?e.jsx(O.Fragment,{children:e.jsx(Fe,{id:y("value"),defaultValue:ae(),placeholder:s("Select taxonomies"),errors:c,register:u,values:R,setValue:j,clearErrors:C,validate:{required:s("This field is mandatory")}})}):e.jsx(O.Fragment,{children:e.jsx(se,{id:y("value"),defaultValue:ae(),placeholder:s("Select taxonomies"),errors:c,register:u,values:[...te,...R],validate:{required:s("This field is mandatory")}})})}return z?e.jsx(O.Fragment,{children:e.jsx(Z,{id:y("value"),disabled:!0,register:u,errors:c,placeholder:`${_?s("Insert values separated by comma. Ex: 12, 54, foo"):s("value")}`,defaultValue:p||l.value})}):e.jsx(O.Fragment,{children:e.jsx(Z,{id:y("value"),register:u,errors:c,placeholder:`${_?s("Insert values separated by comma. Ex: 12, 54, foo"):s("value")}`,defaultValue:p||l.value,validate:{required:s("This field is mandatory")}})})};return e.jsxs("div",{className:"i-flex-center s-8 w-100",children:[e.jsx(he,{id:y("id"),value:l.id,register:u}),e.jsx("div",{className:"w-60",children:e.jsx(se,{id:y("type"),placeholder:s("Select option"),register:u,values:D(),errors:c,defaultValue:g||Ee(l.type),validate:{required:s("This field is mandatory")}})}),e.jsx("div",{className:"w-40",children:e.jsx(se,{id:y("operator"),muted:!0,placeholder:s("Select option"),register:u,disabled:L(),values:le(I),errors:c,defaultValue:g||l.operator,validate:{required:s("This field is mandatory")}})}),e.jsx("div",{className:"w-100",children:ue()?H():e.jsx(Z,{id:y("value"),placeholder:s(""),register:u,errors:c,value:"",defaultValue:p||l.value,disabled:!0})}),e.jsx("div",{className:"w-20",children:!b&&e.jsx(O.Fragment,{children:e.jsx(se,{muted:!0,id:y("logic"),placeholder:s("Select option"),register:u,values:[{label:s("AND"),value:"AND"},{label:s("OR"),value:"OR"}],errors:c,defaultValue:S||l.logic,validate:{required:s("This field is mandatory")}})})}),e.jsxs("div",{className:"i-flex-center s-8",children:[e.jsx(P,{label:e.jsx(je,{id:y("frontEnd"),control:x,defaultValue:typeof A=="boolean"?A:l.frontEnd,errors:c,icon:"bx:devices",disabled:!ue()}),tip:s("Show in Front-End"),icon:!1}),e.jsx(P,{label:e.jsx(je,{id:y("backEnd"),control:x,defaultValue:typeof F=="boolean"?F:l.backEnd,errors:c,icon:"bx:cog",disabled:!ue()}),tip:s("Show in Back-End"),icon:!1})]}),e.jsx(dl,{boxId:n,fieldId:r,elementId:l.id,parentFieldId:v,elementIndex:i})]})};cl.propTypes={elementIndex:a.number.isRequired,boxIndex:a.number.isRequired,fieldIndex:a.number.isRequired,boxId:a.string.isRequired,fieldId:a.string.isRequired,element:a.object.isRequired,isLast:a.bool.isRequired,parentFieldIndex:a.string,parentFieldId:a.string};const ul=({boxIndex:i,fieldIndex:t,boxId:o,field:n,parentFieldIndex:r,parentFieldId:l})=>{const d=W(),[v]=xe(),b=()=>{const m={id:oe(),type:null,operator:"=",value:"",logic:null,frontEnd:!0,backEnd:!0};d(Kl({boxId:o,fieldId:n.id,parentFieldId:l,element:m}))};return e.jsxs("div",{ref:v,className:n.visibilityConditions&&n.visibilityConditions.length>0?"flex-column s-24":"",children:[n.visibilityConditions&&n.visibilityConditions.length>0?e.jsx(O.Fragment,{children:n.visibilityConditions.map((m,h)=>e.jsx(cl,{elementIndex:h,boxIndex:i,fieldIndex:t,boxId:o,fieldId:n.id,element:m,parentFieldIndex:r,parentFieldId:l,isLast:h===n.visibilityConditions.length-1},m.id))}):e.jsx(me,{style:V.WARNING,children:s('No conditions are present, click on "Add condition" button to add the first one.')}),e.jsx("span",{children:e.jsx("a",{href:"#",className:n.visibilityConditions&&n.visibilityConditions.length>0?"":"mt-24",onClick:m=>{m.preventDefault(),b()},children:s("Add condition")})})]})};ul.propTypes={boxIndex:a.number.isRequired,fieldIndex:a.number.isRequired,boxId:a.string.isRequired,parentFieldIndex:a.string,parentFieldId:a.string,field:a.object.isRequired};const hl=({boxId:i,fieldId:t,ruleId:o,ruleIndex:n,parentFieldId:r})=>{const l=W(),{group:d}=K(u=>u.metaState),v=()=>`${X(d.boxes,i,t)}.validationRules`,{control:b}=G(),{remove:m}=ne({control:b,name:v()}),[h,T]=k.useState(!1),y=[e.jsx(Y,{style:V.SUCCESS,onClick:u=>{u.preventDefault(),m(n),l(Hl({boxId:i,fieldId:t,parentFieldId:r,ruleId:o})),T(!h)},children:s("Yes")}),e.jsx(Y,{style:V.DANGER,onClick:u=>{u.preventDefault(),T(!h)},children:s("No")})];return e.jsxs("div",{children:[e.jsx(ce,{title:s("Confirm deleting validation rule"),visible:h,buttons:y,children:s("Are you sure?")}),e.jsx("a",{href:"#",onClick:u=>{u.preventDefault(),T(!h)},children:e.jsx(P,{icon:!1,tip:s("Delete"),label:e.jsx(U,{icon:"bx-minus"})})})]})};hl.propTypes={boxId:a.string.isRequired,fieldId:a.string.isRequired,ruleId:a.string.isRequired,ruleIndex:a.number.isRequired,parentFieldId:a.string};const ml=k.memo(({ruleIndex:i,boxIndex:t,fieldIndex:o,boxId:n,fieldId:r,rule:l,formId:d,parentFieldIndex:v,parentFieldId:b})=>{const m=R=>`${d(`validationRules.${i}.${R}`)}`,{register:h,formState:{errors:T},control:y,setValue:u}=G(),c=M({control:y,name:m("condition")}),x=M({control:y,name:m("value")}),j=M({control:y,name:m("message")}),C=()=>c||l.condition,E=()=>j||(l.message?l.message:q(C())),q=R=>{let N;switch(R){case"blank":N="Value is not blank";break;case"not_blank":N="Value is blank";break;case"=":N="Value is not equal to {{v}}";break;case"!=":N="Value is equals to {{v}}";break;case">":N="Value is lower or equals than {{v}}";break;case">=":N="Value is lower than {{v}}";break;case"<":N="Value is greatest or equals than {{v}}";break;case"<=":N="Value is greatest than {{v}}";break;case"max":N="The maximum length is {{v}}";break;case"min":N="The minimum length is {{v}}";break;case"regex":N="Regex value is not matching {{v}}";break}return s(N)},I=R=>R==="blank"||R==="not_blank",g=R=>{p(q(R)),u(m("message"),q(R)),A(I(R)),I(R)&&u(m("value"),null)},[f,p]=k.useState(E()),[S,A]=k.useState(I(c||l.condition)),F=[{value:"blank",label:s("is empty")},{value:"not_blank",label:s("is not empty")},{value:"=",label:s("is equal to")},{value:"!=",label:s("is not equal to")},{value:">",label:s("is greater than")},{value:">=",label:s("is greater than or equal to")},{value:"<",label:s("is less than")},{value:"<=",label:s("is less than or equal to")},{value:"max",label:s("max length is")},{value:"min",label:s("min length is")},{value:"regex",label:s("regular expression")}];return e.jsxs("div",{className:"i-flex-center s-24 w-100",children:[e.jsx(he,{id:m("id"),value:l.id,register:h}),e.jsx("div",{className:"w-40",children:e.jsx(se,{id:m("condition"),muted:!0,register:h,defaultValue:C(),values:F,errors:T,onChangeCapture:R=>g(R.target.value),validate:{required:s("This field is mandatory")}})}),!S&&e.jsx("div",{className:"w-100",children:e.jsx(Z,{id:m("value"),register:h,errors:T,defaultValue:x||l.value,validate:{required:s("This field is mandatory"),maxLength:{value:255,message:"max length is 255"}}})}),e.jsx("div",{className:"w-100",children:e.jsx(Z,{id:m("message"),register:h,errors:T,defaultValue:f,validate:{required:s("This field is mandatory"),maxLength:{value:255,message:"max length is 255"}}})}),e.jsx(hl,{boxId:n,fieldId:r,ruleId:l.id,parentFieldId:b,ruleIndex:i})]})});ml.propTypes={formId:a.func.isRequired,ruleIndex:a.number.isRequired,boxIndex:a.number.isRequired,fieldIndex:a.number.isRequired,boxId:a.string.isRequired,fieldId:a.string.isRequired,rule:a.object.isRequired,parentFieldIndex:a.string,parentFieldId:a.string};const pl=({boxIndex:i,fieldIndex:t,boxId:o,field:n,formId:r,parentFieldIndex:l,parentFieldId:d})=>{const v=W(),[b]=xe(),m=()=>{const h={id:oe(),condition:"=",value:""};v(Yl({boxId:o,fieldId:n.id,parentFieldId:d,rule:h}))};return e.jsxs("div",{ref:b,className:n.validationRules&&n.validationRules.length>0?"flex-column s-24":"",children:[n.validationRules&&n.validationRules.length>0?e.jsx(O.Fragment,{children:n.validationRules.map((h,T)=>e.jsx(ml,{formId:r,boxId:o,fieldId:n.id,fieldIndex:t,rule:h,boxIndex:i,parentFieldIndex:l,parentFieldId:d,ruleIndex:T}))}):e.jsx(me,{style:V.WARNING,children:s('No rules already created. Create the first one now by clicking the button "Add rule"!')}),e.jsx("a",{href:"#",className:n.validationRules&&n.validationRules.length>0?"":"mt-24",onClick:h=>{h.preventDefault(),m()},children:s("Add rule")})]})};pl.propTypes={formId:a.func.isRequired,boxIndex:a.number.isRequired,fieldIndex:a.number.isRequired,boxId:a.string.isRequired,field:a.object.isRequired,parentFieldIndex:a.string,parentFieldId:a.string};const is=({boxIndex:i,fieldIndex:t,view:o,boxId:n,field:r,parentFieldIndex:l,parentFieldId:d,parentBlockId:v,setActiveTab:b})=>{const{attributes:m,listeners:h,setNodeRef:T,transform:y}=Te({id:r.id}),u={transform:Ce.Translate.toString(y)},[c]=xe(),{register:x,control:j}=G(),C=W(),{group:E,closedElements:q,activeElement:I}=K(F=>F.metaState),g=()=>{const F=q.filter(R=>R===r.id);return typeof F>"u"?!1:F.length>0},f=()=>I?I===r.id:!1,p=F=>`${X(E.boxes,n,r.id)}.${F}`,S=M({control:j,name:p("type")}),A=()=>{let F="bg-white p-24";const R=f();return o!=="accordion"&&(F=F+" b-rounded"),o==="list"&&(F=F+" with-shadow"),R&&o!=="tabular"&&(F=F+" bg-secondary with-primary-border"),o==="accordion"&&!R&&(F=F+" b-bottom-1"),F};return e.jsx(it,{id:r.id,size:{type:"field",children:r.children?r.children.length:0},isClosed:g(),element:e.jsx("div",{onMouseDownCapture:()=>{f()||C(zl({fieldId:r.id}))},children:e.jsxs("div",{id:r.id,className:A(),ref:o==="list"||o==="accordion"?T:null,style:o==="list"||o==="accordion"?u:null,children:[e.jsx(he,{id:p("id"),value:r.id,register:x}),e.jsx(he,{id:p("parentId"),value:d||"",register:x}),e.jsx(he,{id:p("blockId"),value:v||"",register:x}),e.jsx("div",{className:o==="tabular"||!g()&&(o==="list"||o==="accordion")?"mb-24":"",children:e.jsx(Vs,{setActiveTab:b,boxIndex:i,fieldIndex:t,parentFieldId:d,parentBlockId:v,formId:p,attributes:o==="list"||o==="accordion"?m:null,listeners:o==="list"||o==="accordion"?h:null,boxId:n,field:r,view:o})}),e.jsx("div",{ref:c,children:e.jsx("div",{className:`${(o==="list"||o==="accordion")&&g()?"hidden":""}`,children:e.jsxs(nt,{children:[e.jsx(Oe,{title:e.jsxs(O.Fragment,{children:[e.jsx("span",{className:"visible-xs",children:e.jsx(U,{icon:"bx:cog",width:24})}),e.jsx("span",{className:"hidden-xs",children:s("BASIC OPTIONS")})]}),children:e.jsx(ol,{view:o,boxIndex:i,fieldIndex:t,formId:p,boxId:n,field:r})}),e.jsx(Oe,{title:e.jsxs(O.Fragment,{children:[e.jsx("span",{className:"visible-xs",children:e.jsx(U,{icon:"solar:tuning-2-outline",width:24})}),e.jsx("span",{className:"hidden-xs",children:s("ADVANCED OPTIONS")})]}),children:e.jsx(rl,{boxIndex:i,fieldIndex:t,field:r,formId:p})}),e.jsx(Oe,{title:e.jsxs(O.Fragment,{children:[e.jsx("span",{className:"visible-xs",children:e.jsx(U,{icon:"bx:low-vision",width:24})}),e.jsx("span",{className:"hidden-xs",children:s("CONDITIONAL LOGIC")})]}),children:e.jsx(ul,{boxIndex:i,fieldIndex:t,boxId:n,field:r,parentFieldIndex:l,parentFieldId:d,formId:p})}),Me(S||r.type)&&e.jsx(Oe,{title:e.jsxs(O.Fragment,{children:[e.jsx("span",{className:"visible-xs",children:e.jsx(U,{icon:"bx:check-double",width:24})}),e.jsx("span",{className:"hidden-xs",children:s("VALIDATION RULES")})]}),children:e.jsx(pl,{boxIndex:i,fieldIndex:t,boxId:n,field:r,parentFieldIndex:l,parentFieldId:d,formId:p})})]})})})]})})})};is.propTypes={boxIndex:a.number.isRequired,fieldIndex:a.number.isRequired,view:a.oneOf(["list","accordion","tabular"]).isRequired,boxId:a.string.isRequired,field:a.object.isRequired,parentFieldIndex:a.string,parentFieldId:a.string,parentBlockId:a.string,setActiveTab:a.func};const Ge=({boxIndex:i,boxId:t,parentFieldIndex:o,parentFieldId:n,parentBlockId:r,fields:l,addFieldEnabled:d=!0,view:v})=>{const b=W(),{group:m}=K(j=>j.metaState),[h]=xe(),T=()=>r?`${X(m.boxes,t,r)}.fields`:n?`${X(m.boxes,t,n)}.children`:`boxes.${i}.fields`,{control:y}=G(),{move:u}=ne({control:y,name:T()}),c=j=>{const{active:C,over:E}=j;if(C.id===E.id)return;const q=l.findIndex(f=>f.id===C.id),I=l.findIndex(f=>f.id===E.id),g=Re(l,q,I);u(q,I),b(gs({boxId:t,parentFieldId:n,parentBlockId:r,sortedFields:g}))},x=()=>{const j={id:oe(),boxId:t,name:"meta_box_field",label:"meta box field",type:w.TEXT,defaultValue:"",description:"",isRequired:!1,showInArchive:!1,quickEdit:!1,filterableInAdmin:!1,sort:1,advancedOptions:[],options:[],blocks:[],blockId:r||null,validationRules:[],visibilityConditions:[],hasManyRelation:[],children:[],parentId:n||null,isATextualField:!0,isFilterable:!0,isSaved:!1};b(Be({boxId:t,parentFieldId:n,parentBlockId:r,field:j}))};return e.jsxs(O.Fragment,{children:[e.jsx("div",{className:l&&l.length>0&&v==="list"?"bg-pale-gray b-rounded p-24 flex-column s-24":"",ref:h,children:l&&l.length>0?e.jsx(ve,{onDragEnd:c,items:l,children:l.map((j,C)=>e.jsx(is,{boxIndex:i,fieldIndex:C,boxId:t,field:j,parentFieldIndex:o,parentFieldId:n,parentBlockId:r,view:v}))}):e.jsx("div",{style:v==="accordion"?{padding:"24px 24px 0"}:{},children:e.jsx(me,{style:V.WARNING,children:s('No field box already created. Create the first one now by clicking the button "Add field box"!')})})}),d&&e.jsx("div",{className:v==="accordion"?"p-24":"",children:e.jsx("a",{className:`acpt-btn acpt-btn-secondary acpt-btn-sm ${v!=="accordion"?"mt-24":""}`,href:"#",onClick:j=>{j.preventDefault(),x()},children:s("Add field box")})})]})};Ge.propTypes={boxIndex:a.number.isRequired,boxId:a.string.isRequired,fields:a.array.isRequired,parentFieldIndex:a.string,parentFieldId:a.string,parentBlockId:a.string,addFieldEnabled:a.bool,view:a.string};const Pe=({index:i,box:t,view:o,setActiveTab:n})=>{const{attributes:r,listeners:l,setNodeRef:d,transform:v}=Te({id:t.id}),b={transform:Ce.Translate.toString(v)},{closedElements:m}=K(y=>y.metaState),h=()=>m.filter(u=>u===t.id).length===1,T=()=>{if(o==="list"||o==="accordion"){let y="bg-white b-rounded with-shadow";return o==="list"&&(y=y+" p-24"),y}return""};return e.jsxs("div",{id:t.id,className:T(),ref:o==="list"||o==="accordion"?d:null,style:o==="list"||o==="accordion"?b:null,children:[e.jsx("div",{className:o==="tabular"||!h()&&o==="list"?"mb-24":"",children:e.jsx(Ms,{index:i,setActiveTab:n,attributes:o==="list"||o==="accordion"?r:null,listeners:o==="list"||o==="accordion"?l:null,box:t,view:o})}),o==="list"||o==="accordion"?e.jsx("div",{className:`${h()?"hidden":""}`,children:e.jsx(Ge,{boxIndex:i,boxId:t.id,fields:t.fields,view:o})}):e.jsx("div",{children:e.jsx(_e,{boxIndex:i,boxId:t.id,fields:t.fields})})]})};Pe.propTypes={index:a.number.isRequired,box:a.object.isRequired,setActiveTab:a.func,view:a.oneOf(["list","tabular"]).isRequired};const Ue=({groupId:i,settingsVisible:t,setSettingsVisible:o})=>{const{register:n,formState:{errors:r},control:l}=G(),d=M({control:l,name:"name"}),v=M({control:l,name:"label"}),{group:b}=K(T=>T.metaState),m=()=>r&&r.name?e.jsx("span",{className:"invalid-feedback",children:s("Group name error(s). Please fix it.")}):r&&r.belongs?e.jsx("span",{className:"invalid-feedback",children:s("Location rules error(s). Please fix it.")}):d?e.jsx("span",{children:d}):e.jsx("span",{children:Q(b)?"group_name":b.name}),h=()=>v?e.jsx("span",{className:"color-gray",children:v}):!Q(b)&&b.label?e.jsx("span",{className:"color-gray",children:b.label}):s("Group name");return e.jsxs(O.Fragment,{children:[e.jsx(he,{id:"id",value:i,register:n}),e.jsxs("div",{className:"i-flex-center s-8",children:[e.jsx("h3",{children:m()}),h()&&e.jsx("span",{className:"top-1",children:h()}),e.jsx("a",{href:"#",onClick:T=>{T.preventDefault(),o(!t)},children:s(t?"Close settings":"Open settings")})]})]})};Ue.propTypes={groupId:a.string.isRequired,settingsVisible:a.bool.isRequired,setSettingsVisible:a.func.isRequired};const xl=({id:i,control:t,register:o,errors:n,belong:r,handleDeleteBelong:l,values:d,isLast:v,index:b,resetField:m,setValue:h,clearErrors:T,format:y="all"})=>{const{data:u}=K(A=>A.fetchMeta),c=A=>`${i}.${b}.${A}`,x=M({control:t,name:c("belongsTo")}),j=M({control:t,name:c("operator")}),C=M({control:t,name:c("find")});k.useEffect(()=>{v&&m(c("logic"))},[v]),k.useEffect(()=>{x!==r.belongsTo&&m(c("find"))},[x]),k.useEffect(()=>{j||h(c("operator"),"=")},[j]);const E=()=>x?d[x]?d[x]:[]:u.belongs&&u.belongs[b]?d[u.belongs[b].belongsTo]?d[u.belongs[b].belongsTo]:[]:[],q=()=>C?typeof C=="string"?C.split(","):C:[],I=()=>y==="reduced"?[{value:null,label:s("Select")},{label:s("Posts"),options:[{value:J.CUSTOM_POST_TYPE,label:s("Post type")},{value:"POST_ID",label:s("Post")}]},{label:s("Taxonomies"),options:[{value:J.TAXONOMY,label:s("Taxonomy")},{value:"TERM_ID",label:s("Term")}]}]:[{value:null,label:s("Select")},{label:s("Posts"),options:[{value:J.CUSTOM_POST_TYPE,label:s("Post type")},{value:"POST_ID",label:s("Post")},{value:"POST_CAT",label:s("Post category")},{value:"POST_TAX",label:s("Post taxonomy")},{value:"POST_TEMPLATE",label:s("Post template")}]},{label:s("Taxonomies"),options:[{value:J.TAXONOMY,label:s("Taxonomy")},{value:"TERM_ID",label:s("Term")}]},{label:s("Attachment"),options:[{value:J.MEDIA,label:s("Attachment")}]},{label:s("Option pages"),options:[{value:J.OPTION_PAGE,label:s("Option page")}]},{label:s("Comments"),options:[{value:J.COMMENT,label:s("All comments")}]},{label:s("Users"),options:[{value:J.USER,label:s("All users")},{value:"USER_ID",label:s("User")}]}],g=[{value:null,label:s("Select")},{value:"=",label:s("is equal to")},{value:"!=",label:s("is not equal to")},{value:"IN",label:s("is included in")},{value:"NOT_IN",label:s("is not included in")}],f=[{value:null,label:s("Select")},{label:s("AND"),value:"AND"},{label:s("OR"),value:"OR"}],p=()=>x===J.USER||x===J.COMMENT?!0:!x,S=()=>x===J.USER||x===J.COMMENT?{required:!1}:{required:s("This field is mandatory")};return e.jsxs("div",{id:r.id,className:"i-flex-center s-8",children:[e.jsx(he,{register:o,id:c("id"),value:r.id}),e.jsx("div",{className:"w-100",children:e.jsx(se,{register:o,id:c("belongsTo"),values:I(),errors:n,onChangeCapture:()=>{m(c("find")),h(c("find"),[])},validate:{required:s("This field is mandatory")}})}),e.jsx("div",{className:"w-40",children:e.jsx(se,{muted:!0,register:o,id:c("operator"),values:g,defaultValue:"=",errors:n,disabled:p(),validate:S()})}),e.jsx("div",{className:"w-100",children:j==="IN"||j==="NOT_IN"?e.jsx(Fe,{register:o,id:c("find"),values:E(),errors:n,disabled:p(),validate:S(),setValue:h,clearErrors:T,defaultValue:q()}):e.jsx(se,{register:o,id:c("find"),values:E(),errors:n,disabled:p(),validate:S()})}),e.jsx("div",{className:"w-40",children:!v&&e.jsx(se,{muted:!0,register:o,id:c("logic"),values:f,errors:n,validate:{required:s("This field is mandatory")}})}),e.jsx("div",{children:e.jsx("a",{href:"#",onClick:A=>{A.preventDefault(),l(b,r.id)},children:e.jsx(P,{icon:!1,tip:s("Delete"),label:e.jsx(U,{icon:"bx-minus"})})})})]})};xl.propTypes={id:a.string.isRequired,index:a.number.isRequired,belong:a.object.isRequired,register:a.func.isRequired,errors:a.object.isRequired,isLast:a.bool.isRequired,handleDeleteBelong:a.func.isRequired,resetField:a.func.isRequired,setValue:a.func.isRequired,clearErrors:a.func.isRequired,format:a.oneOf(["all","reduced"])};const bl=({id:i,control:t,register:o,handleAddBelong:n,handleDeleteBelong:r,conditions:l,values:d,errors:v,resetField:b,setValue:m,clearErrors:h,format:T="all"})=>{const[y]=xe();return e.jsxs(O.Fragment,{children:[e.jsx("div",{className:`mb-12 ${!Q(d)&&l&&l.length>0?"flex-column s-12":""}`,ref:y,children:!Q(d)&&l&&l.length>0?e.jsx(O.Fragment,{children:l.map((u,c)=>e.jsx(xl,{id:i,format:T,register:o,errors:v,control:t,belong:u,index:c,handleDeleteBelong:r,values:d,isLast:c===l.length-1,resetField:b,setValue:m,clearErrors:h}))}):e.jsx(me,{style:V.WARNING,children:s('No conditions are present, click on "Add condition" button to add the first one.')})}),e.jsx(Y,{type:"button",style:V.SECONDARY,onClick:()=>{n()},children:s("Add condition")})]})};bl.propTypes={id:a.string.isRequired,values:a.array.isRequired,append:a.func.isRequired,register:a.func.isRequired,unregister:a.func.isRequired,resetField:a.func.isRequired,conditions:a.array.isRequired,errors:a.array.isRequired,handleDeleteBelong:a.func.isRequired,handleAddBelong:a.func.isRequired,setValue:a.func.isRequired,clearErrors:a.func.isRequired,format:a.oneOf(["all","reduced"])};const Ke=({groupId:i,setSettingsVisible:t})=>{const n=document.globals.globals,r=W(),{group:l}=K(f=>f.metaState),d=n.find,{control:v,register:b,unregister:m,formState:{errors:h},setValue:T,resetField:y,clearErrors:u}=G(),{append:c,remove:x}=ne({control:v,name:"belongs"}),j=()=>{const f={id:oe(),belongsTo:null,operator:null,find:null,logic:null};r(Wl({belong:f}))},C=(f,p)=>{r(Xl({belongId:p})),x(f)},[E,q]=k.useState(!0),I=()=>e.jsxs("div",{className:"flex-between s-8",children:[e.jsx("span",{children:s("Group label")}),e.jsx("a",{href:"#",onClick:f=>{f.preventDefault(),q(!E)},children:s(`${E?"Auto slug ON":"Auto slug OFF"}`)})]}),g=()=>[{label:s("Standard view"),value:ke.STANDARD},{label:s("Accordion"),value:ke.ACCORDION},{label:s("Horizontal tabs"),value:ke.HORIZONTAL_TABS},{label:s("Vertical tabs"),value:ke.VERTICAL_TABS}];return e.jsx("div",{className:"mb-24 bg-white with-shadow p-24",children:e.jsxs("div",{className:"flex-column s-24",children:[e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"col-4",children:[e.jsx(fe,{id:"label",label:I()}),e.jsx(Z,{id:"label",register:b,placeholder:s("Group label"),defaultValue:Q(l)?null:l.label,errors:h,onChangeCapture:f=>{E&&T("name",Ie(Ae(f.target.value)))},onClick:f=>{f.target.value==="group name"&&y("label")},validate:{maxLength:{value:255,message:"max length is 255"}}})]}),e.jsxs("div",{className:"col-4",children:[e.jsx(fe,{id:"name",label:s("Group name")}),e.jsx(Z,{id:"name",register:b,placeholder:s("Group name"),defaultValue:Q(l)?"group_name":l.name,errors:h,isRequired:!0,validate:{validate:$e,required:s("This field is mandatory"),maxLength:{value:255,message:"max length is 255"}}})]}),e.jsxs("div",{className:"col-4",children:[e.jsx(fe,{id:"display",label:s("Display as")}),e.jsx(se,{id:"display",register:b,errors:h,values:g(),defaultValue:!Q(l)&&l.display?l.display:ke.STANDARD})]})]}),e.jsxs("fieldset",{className:"acpt-fieldset",children:[e.jsx("legend",{children:s("Location")}),e.jsx(bl,{id:"belongs",values:d,conditions:l.belongs?l.belongs:[],append:c,register:b,unregister:m,remove:x,errors:h,control:v,handleAddBelong:j,handleDeleteBelong:C,resetField:y,setValue:T,clearErrors:u})]}),e.jsx("a",{href:"#",onClick:f=>{f.preventDefault(),t(!1)},children:s("Close settings")})]})})};Ke.propTypes={groupId:a.string.isRequired,setSettingsVisible:a.func.isRequired};const fl=({boxIds:i,modalOpen:t,setModalOpen:o})=>{const r=document.globals.globals,{setValue:l}=G(),d=W(),{id:v}=pe(),[b,m]=k.useState(null),[h,T]=k.useState(!1),y=()=>{let u=[];i.map(c=>{u.push(c.id)}),re("copyMetaBoxesAction",{boxIds:u,targetGroupId:b,delete:h}).then(c=>{c.success?(de.success(`${s("Meta box was successfully copied")}.${s("The browser will refresh after 5 seconds.")}`),o(!t),d(ss()),v===b&&d(Ne({id:v})).then(x=>{d(ge(x.payload)),l("id",v),l("name",x.payload.name),l("label",x.payload.label),l("display",x.payload.display),x.payload.belongs&&x.payload.belongs.map((j,C)=>{l(`belongs.${C}.id`,j.id),l(`belongs.${C}.belongsTo`,j.belongsTo),l(`belongs.${C}.operator`,j.operator),l(`belongs.${C}.find`,j.find),l(`belongs.${C}.logic`,j.logic)}),x.payload.boxes&&x.payload.boxes.map((j,C)=>{l(`boxes.${C}`,j)})}).catch(x=>{console.error(x)})):de.error(c.error)}).catch(c=>console.error(c))};return e.jsx(O.Fragment,{children:e.jsx(ce,{title:s("Copy selected meta boxes"),visible:t,buttons:[],children:e.jsxs("div",{className:"flex-column s-24",children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label i-flex-center s-4",htmlFor:"group",children:s("Meta group")}),e.jsx("div",{className:"acpt-select",children:e.jsx("select",{id:"group",className:"form-control default",onChangeCapture:u=>m(u.target.value),children:r.find.meta.map(u=>e.jsx("option",{value:u.value,children:u.label}))})})]}),b&&b!=="Select"&&e.jsxs("div",{children:[e.jsxs("div",{className:"w-100 i-flex-center s-4 mb-8",children:[e.jsx("input",{type:"checkbox",defaultValue:h,onClick:()=>T(!h),id:"deleteBoxes"}),e.jsx("label",{htmlFor:"deleteBoxes",children:s("Delete after copying")})]}),e.jsx(Y,{onClick:()=>y(),style:V.PRIMARY,children:s("Copy")})]})]})})})};fl.propTypes={boxIds:a.array.isRequired,modalOpen:a.bool.isRequired,setModalOpen:a.func.isRequired};const gl=({fieldIds:i,modalOpen:t,setModalOpen:o})=>{const r=document.globals.globals,{setValue:l}=G(),d=W(),{id:v}=pe(),[b,m]=k.useState(null),[h,T]=k.useState([]),[y,u]=k.useState([]),[c,x]=k.useState(null),[j,C]=k.useState(null),[E,q]=k.useState(!1);k.useEffect(()=>{m(null),T([]),u([]),x(null),C(null),q(!1)},[t]);const I=S=>{m(S),T([]),u([]),x(null),C(null),q(!1),re("fetchMetaAction",{id:S}).then(A=>{T(A.boxes)}).catch(A=>console.error(A))},g=S=>{u([]),x("box"),C(S);const A=h.filter(F=>F.id===S)[0].fields;if(A&&A.length>0){const F=A.filter(R=>R.type===w.REPEATER||R.type===w.FLEXIBLE);F&&F.length>0&&u(F)}},f=S=>{x("field"),C(S)},p=()=>{let S=[];i.map(A=>{S.push(A.id)}),re("copyMetaFieldsAction",{fieldIds:S,targetEntityType:c,targetEntityId:j,delete:E}).then(A=>{A.success?(de.success(`${s("Meta field was successfully copied")}.`),o(!t),d(ss()),v===b&&d(Ne({id:v})).then(F=>{d(ge(F.payload)),l("id",v),l("name",F.payload.name),l("label",F.payload.label),l("display",F.payload.display),F.payload.belongs&&F.payload.belongs.map((R,N)=>{l(`belongs.${N}.id`,R.id),l(`belongs.${N}.belongsTo`,R.belongsTo),l(`belongs.${N}.operator`,R.operator),l(`belongs.${N}.find`,R.find),l(`belongs.${N}.logic`,R.logic)}),F.payload.boxes&&F.payload.boxes.map((R,N)=>{l(`boxes.${N}`,R)})}).catch(F=>{console.error(F)})):de.error(A.error)}).catch(A=>console.error(A))};return e.jsx(O.Fragment,{children:e.jsx(ce,{title:s("Copy selected meta fields"),visible:t,buttons:[],children:e.jsxs("div",{className:"flex-column s-24",children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label i-flex-center s-4",htmlFor:"group",children:s("Meta group")}),e.jsx("div",{className:"acpt-select",children:e.jsx("select",{id:"group",className:"form-control default",onChangeCapture:S=>I(S.target.value),children:r.find.meta.map(S=>e.jsx("option",{value:S.value,children:S.label}))})})]}),h&&h.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"form-label i-flex-center s-4",htmlFor:"box",children:s("Meta box")}),e.jsx("div",{className:"acpt-select",children:e.jsxs("select",{id:"box",className:"form-control default",onChangeCapture:S=>g(S.target.value),children:[e.jsx("option",{value:null,children:s("Select")}),h.map(S=>e.jsx("option",{value:S.id,children:S.name}))]})})]}),y&&y.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"form-label i-flex-center s-4",htmlFor:"field",children:s("Meta field")}),e.jsx("div",{className:"acpt-select",children:e.jsxs("select",{id:"field",className:"form-control default",onChangeCapture:S=>f(S.target.value),children:[e.jsx("option",{value:null,children:s("Select")}),y.map(S=>e.jsx("option",{value:S.id,children:S.name}))]})})]}),c&&j&&e.jsxs("div",{children:[e.jsxs("div",{className:"w-100 i-flex-center s-4 mb-8",children:[e.jsx("input",{type:"checkbox",defaultValue:E,onClick:()=>q(!E),id:"deleteFields"}),e.jsx("label",{htmlFor:"deleteFields",children:s("Delete the meta field after copying")})]}),e.jsx(Y,{onClick:()=>p(),style:V.PRIMARY,children:s("Copy")})]})]})})})};gl.propTypes={fieldIds:a.array.isRequired,modalOpen:a.bool.isRequired,setModalOpen:a.func.isRequired};const vl=({blockIds:i,modalOpen:t,setModalOpen:o})=>{const r=document.globals.globals,{setValue:l}=G(),d=W(),{id:v}=pe(),[b,m]=k.useState(null),[h,T]=k.useState([]),[y,u]=k.useState([]),[c,x]=k.useState(null),[j,C]=k.useState(!1);k.useEffect(()=>{m(null),T([]),u([]),x(null),C(!1)},[t]);const E=f=>{m(f),T([]),u([]),x(null),C(!1),re("fetchMetaAction",{id:f}).then(p=>{T(p.boxes)}).catch(p=>console.error(p))},q=f=>{u([]);const p=h.filter(S=>S.id===f)[0].fields;u(p)},I=f=>{x(f)},g=()=>{let f=[];i.map(p=>{f.push(p.id)}),re("copyMetaBlocksAction",{blockIds:f,targetFieldId:c,delete:j}).then(p=>{p.success?(de.success(`${s("Meta block was successfully copied")}.${s("The browser will refresh after 5 seconds.")}`),o(!t),v===b&&d(Ne({id:v})).then(S=>{d(ge(S.payload)),l("id",v),l("name",S.payload.name),l("label",S.payload.label),l("display",S.payload.display),S.payload.belongs&&S.payload.belongs.map((A,F)=>{l(`belongs.${F}.id`,A.id),l(`belongs.${F}.belongsTo`,A.belongsTo),l(`belongs.${F}.operator`,A.operator),l(`belongs.${F}.find`,A.find),l(`belongs.${F}.logic`,A.logic)}),S.payload.boxes&&S.payload.boxes.map((A,F)=>{l(`boxes.${F}`,A)})}).catch(S=>{console.error(S)})):de.error(p.error)}).catch(p=>console.error(p))};return e.jsx(ce,{title:s("Copy selected meta blocks"),visible:t,buttons:[],children:e.jsxs("div",{className:"flex-column s-24",children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label i-flex-center s-4",htmlFor:"group",children:s("Meta group")}),e.jsx("div",{className:"acpt-select",children:e.jsx("select",{id:"group",className:"form-control default",onChangeCapture:f=>E(f.target.value),children:r.find.meta.map(f=>e.jsx("option",{value:f.value,children:f.label}))})})]}),h&&h.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"form-label i-flex-center s-4",htmlFor:"box",children:s("Meta box")}),e.jsx("div",{className:"acpt-select",children:e.jsxs("select",{id:"box",className:"form-control default",onChangeCapture:f=>q(f.target.value),children:[e.jsx("option",{value:null,children:s("Select")}),h.map(f=>e.jsx("option",{value:f.id,children:f.name}))]})})]}),y&&y.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"form-label i-flex-center s-4",htmlFor:"field",children:s("Meta field")}),e.jsx("div",{className:"acpt-select",children:e.jsxs("select",{id:"field",className:"form-control default",onChangeCapture:f=>I(f.target.value),children:[e.jsx("option",{value:null,children:s("Select")}),y.map(f=>e.jsx("option",{value:f.id,children:f.name}))]})})]}),c&&e.jsxs("div",{children:[e.jsxs("div",{className:"w-100 i-flex-center s-4 mb-8",children:[e.jsx("input",{type:"checkbox",defaultValue:j,onClick:()=>C(!j),id:"deleteBlocks"}),e.jsx("label",{htmlFor:"deleteBlocks",children:s("Delete the meta block after copying")})]}),e.jsx(Y,{onClick:()=>g(),style:V.PRIMARY,children:s("Copy")})]})]})})};vl.propTypes={blockIds:a.array.isRequired,modalOpen:a.bool.isRequired,setModalOpen:a.func.isRequired};const He=({view:i,setFieldTab:t,setBoxTab:o,setBlockTab:n})=>{const r=W(),{selectedElements:l,selectedElementsType:d}=K(g=>g.metaState),{control:v,setValue:b,getValues:m}=G(),h=M({control:v,name:"boxes"}),T=k.useRef(null),[y,u]=k.useState(null),[c,x]=k.useState(!1),[j,C]=k.useState(!1),[E,q]=k.useState(!1),I=()=>{l.map(g=>{switch(y){case"copy":d==="box"?x(!c):d==="block"?q(!E):C(!j);break;case"duplicate":if(d==="box"){const f=h.findIndex(A=>A.id===g.id),p=h[f],S=ps(p);h.push(S),b("boxes",h),r(Je(S))}else if(d==="block"){const f=rs(h,g.boxId,g.id),p=js(g.boxId,g.parentFieldId,f),S=X(h,g.boxId,g.id,!1),A=m(S);A.push(p),b(S,A),r(Ve({boxId:g.boxId,parentFieldId:g.parentFieldId,block:p}))}else{const f=rs(h,g.boxId,g.id),p=bs(g.boxId,f),S=X(h,g.boxId,g.id,!1),A=m(S);A.push(p),b(S,A),r(Be({boxId:g.boxId,field:p,parentFieldId:g.parentFieldId,parentBlockId:g.parentBlockId}))}break;case"delete":if(d==="box")b("boxes",h.filter(f=>f.id!==g.id)),o&&o(0),r(ms(g.id));else if(d==="block"){const f=X(h,g.boxId,g.id,!1),p=m(f).filter(S=>S.id!==g.id);b(f,p),n&&n(0),r(vs({boxId:g.boxId,parentFieldId:g.parentFieldId,blockId:g.id}))}else{const f=X(h,g.boxId,g.id,!1),p=m(f).filter(S=>S.id!==g.id);b(f,p),t&&t(0),r(xs({boxId:g.boxId,fieldId:g.id,parentFieldId:g.parentFieldId,parentBlockId:g.parentBlockId}))}break}}),(y==="delete"||y==="duplicate")&&r(ss()),T.current.value=""};return e.jsxs(O.Fragment,{children:[e.jsx(fl,{boxIds:l,modalOpen:c,setModalOpen:x}),e.jsx(gl,{fieldIds:l,modalOpen:j,setModalOpen:C}),e.jsx(vl,{blockIds:l,modalOpen:E,setModalOpen:q}),l&&l.length>0&&e.jsxs("div",{className:`flex-between ${i==="tab"?"mb-24":""}`,children:[e.jsxs("div",{children:[l.length," ",s("Selected items")]}),e.jsxs("div",{className:"i-flex-center s-8",children:[e.jsxs("select",{ref:T,className:"form-control sm",onChange:g=>{u(g.target.value!==""?g.target.value:null)},children:[e.jsx("option",{value:"",children:s("Select")}),e.jsx("option",{value:"copy",children:s("Copy")}),e.jsx("option",{value:"duplicate",children:s("Duplicate")}),e.jsx("option",{value:"delete",children:s("Delete")})]}),e.jsx(Y,{style:V.WHITE,size:"sm",disabled:y===null,onClick:g=>{g.preventDefault(),I()},children:s("Execute")})]})]})]})};He.propTypes={view:a.oneOf(["tab","accordion","list"]).isRequired,setBoxTab:a.func,setFieldTab:a.func,setBlockTab:a.func};const jl=({boxes:i,view:t,setView:o})=>{const n=W(),{group:r,closedElements:l}=K(x=>x.metaState),d=oe(),{id:v}=pe(),[b,m]=k.useState(typeof v!="string"),[h]=xe(),{control:T}=G(),{move:y}=ne({control:T,name:"boxes"}),u=x=>{const{active:j,over:C}=x;if(j.id===C.id)return;const E=i.findIndex(g=>g.id===j.id),q=i.findIndex(g=>g.id===C.id),I=Re(i,E,q);y(E,q),n(ls(I))},c=()=>{const x=Ns(r.boxes);l&&l.length>0?(Ts(x),n(Cs())):(Rs(x),n(Ss()))};return e.jsxs(O.Fragment,{children:[e.jsxs("div",{className:"flex-between mb-24 s-8 for-xs",children:[e.jsx(Ue,{groupId:Q(r)?d:r.id,settingsVisible:b,setSettingsVisible:m}),e.jsxs("div",{className:"i-flex-center s-8",children:[e.jsx(P,{label:e.jsx(Y,{css:{height:"40px"},style:V.WHITE,size:"xs",onClick:x=>{x.preventDefault(),c()},children:e.jsx(U,{icon:l&&l.length>0?"ant-design:eye-outlined":"ant-design:eye-invisible-outlined",width:18})}),tip:s("Show/hide all fields"),icon:!1}),e.jsx(as,{localStorageKey:Q(r)?d:r.id,setView:o,view:t,choices:["list","accordion","tabular"]})]})]}),e.jsx("div",{className:b?"":"hidden",children:e.jsx(Ke,{groupId:Q(r)?d:r.id,setSettingsVisible:m})}),e.jsxs("div",{className:"container",children:[e.jsx("div",{className:"col-3 flex-column s-24 hidden-xs sticky",style:{top:"130px"},children:e.jsx(Fs,{boxes:i})}),e.jsx("div",{className:"col-9",children:e.jsxs("div",{className:"flex-column s-24",ref:h,children:[e.jsx(He,{view:"list"}),i&&i.length>0?e.jsx(ve,{onDragEnd:u,items:i,children:e.jsx(O.Fragment,{children:i.map((x,j)=>e.jsx(Pe,{index:j,view:"list",box:x},x.id))})}):e.jsx(me,{style:V.WARNING,children:s('No meta box already created. Create the first one now by clicking the button "Add meta box"!')})]})})]})]})};jl.propTypes={view:a.string.isRequired,setView:a.func.isRequired,boxes:a.array.isRequired};const yl=({index:i,box:t,activeTab:o=0,onClick:n})=>{const{selectedElementsType:r}=K(u=>u.metaState),{control:l}=G(),d=M({control:l,name:`boxes.${i}.name`}),{attributes:v,listeners:b,setNodeRef:m,transform:h}=Te({id:t.id}),T={transform:Ce.Translate.toString(h)},y=()=>!(typeof t.isSaved<"u"&&t.isSaved===!1);return e.jsxs("div",{id:t.id,className:`flex-between s-8 tab ${o===i?"active":""}`,ref:m,style:T,onClick:()=>{n&&n(i)},children:[e.jsx("span",{className:"cursor-move top-2 handle",...v,...b,onMouseDownCapture:()=>{n&&n(i)},children:e.jsx(U,{icon:"bx:dots-vertical-rounded",color:"#777",width:18})}),r!=="field"&&r!=="block"&&y()&&e.jsx(Se,{elementType:"box",element:{id:t.id}}),e.jsx("span",{className:"text-ellipsis",children:d||t.name}),e.jsx(we,{style:i===o?V.SECONDARY:V.DISABLED,children:t.fields?t.fields.length:0})]})};yl.propTypes={index:a.number.isRequired,box:a.object.isRequired,activeTab:a.number};const Nl=({boxes:i,view:t,setView:o,activeBoxTab:n,setActiveBoxTab:r})=>{const l=W(),{group:d}=K(j=>j.metaState),[v]=xe(),b=oe(),{id:m}=pe(),[h,T]=k.useState(typeof m!="string"),y=j=>{r(j)},{control:u}=G(),{move:c}=ne({control:u,name:"boxes"}),x=j=>{const{active:C,over:E}=j;if(C.id===E.id)return;const q=i.findIndex(f=>f.id===C.id),I=i.findIndex(f=>f.id===E.id),g=Re(i,q,I);c(q,I),r(I),l(ls(g))};return e.jsxs(O.Fragment,{children:[e.jsxs("div",{className:"flex-between mb-24",children:[e.jsx(Ue,{groupId:Q(d)?b:d.id,settingsVisible:h,setSettingsVisible:T}),e.jsx(as,{localStorageKey:Q(d)?b:d.id,setView:o,view:t,choices:["list","accordion","tabular"]})]}),e.jsx("div",{className:h?"":"hidden",children:e.jsx(Ke,{groupId:Q(d)?b:d.id,setSettingsVisible:T})}),e.jsxs("div",{ref:v,children:[e.jsx(He,{view:"tab",setBoxTab:r}),i&&i.length>0?e.jsxs("div",{className:"acpt-horizontal-tabs",children:[e.jsx("div",{className:"tablist",children:e.jsx(ve,{onDragEnd:x,items:i,children:i.map((j,C)=>e.jsx(yl,{index:C,box:j,activeTab:n,onClick:y}))})}),i.map((j,C)=>e.jsx(O.Fragment,{children:C===n&&e.jsx("div",{className:"tab-panel",children:e.jsx(Pe,{index:C,view:"tabular",box:j,setActiveTab:r},j.id)})}))]}):e.jsx(me,{style:V.WARNING,children:s('No meta box already created. Create the first one now by clicking the button "Add meta box"!')})]})]})};Nl.propTypes={view:a.string.isRequired,setView:a.func.isRequired,boxes:a.array.isRequired,activeBoxTab:a.number.isRequired,setActiveBoxTab:a.func.isRequired};const Tl=({boxes:i,view:t,setView:o,activeBoxTab:n,setActiveBoxTab:r})=>{const l=W(),{group:d,closedElements:v}=K(C=>C.metaState),b=oe(),{id:m}=pe(),[h,T]=k.useState(typeof m!="string"),[y]=xe(),{control:u}=G(),{move:c}=ne({control:u,name:"boxes"}),x=C=>{const{active:E,over:q}=C;if(E.id===q.id)return;const I=i.findIndex(p=>p.id===E.id),g=i.findIndex(p=>p.id===q.id),f=Re(i,I,g);c(I,g),l(ls(f))},j=()=>{const C=Ns(d.boxes);v&&v.length>0?(Ts(C),l(Cs())):(Rs(C),l(Ss()))};return e.jsxs(O.Fragment,{children:[e.jsxs("div",{className:"flex-between mb-24 s-8 for-xs",children:[e.jsx(Ue,{groupId:Q(d)?b:d.id,settingsVisible:h,setSettingsVisible:T}),e.jsxs("div",{className:"i-flex-center s-8",children:[e.jsx(P,{label:e.jsx(Y,{css:{height:"40px"},style:V.WHITE,size:"xs",onClick:C=>{C.preventDefault(),j()},children:e.jsx(U,{icon:v&&v.length>0?"ant-design:eye-outlined":"ant-design:eye-invisible-outlined",width:18})}),tip:s("Show/hide all fields"),icon:!1}),e.jsx(as,{localStorageKey:Q(d)?b:d.id,setView:o,view:t,choices:["list","accordion","tabular"]})]})]}),e.jsx("div",{className:h?"":"hidden",children:e.jsx(Ke,{groupId:Q(d)?b:d.id,setSettingsVisible:T})}),e.jsx("div",{className:"container",children:e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"flex-column s-24",ref:y,children:[e.jsx(He,{view:"accordion"}),i&&i.length>0?e.jsx(ve,{onDragEnd:x,items:i,children:e.jsx(O.Fragment,{children:i.map((C,E)=>e.jsx(Pe,{index:E,view:"accordion",box:C},C.id))})}):e.jsx(me,{style:V.WARNING,children:s('No meta box already created. Create the first one now by clicking the button "Add meta box"!')})]})})})]})};Tl.propTypes={view:a.string.isRequired,setView:a.func.isRequired,boxes:a.array.isRequired,activeBoxTab:a.number.isRequired,setActiveBoxTab:a.func.isRequired};const ut=()=>{const i=W(),[t,o]=k.useState(!1),{unregister:n}=G(),r=[e.jsx(Y,{style:V.SUCCESS,onClick:l=>{l.preventDefault(),i(Jl()),n("boxes"),o(!t)},children:s("Yes")}),e.jsx(Y,{style:V.DANGER,onClick:l=>{l.preventDefault(),o(!t)},children:s("No")})];return e.jsxs(O.Fragment,{children:[e.jsx(ce,{title:s("Confirm deleting all"),visible:t,buttons:r,children:s("Are you sure?")}),e.jsx(Y,{type:"button",style:V.DANGER,onClick:l=>{l.preventDefault(),o(!t)},children:s("Delete all")})]})},ht=i=>{const t="You have unsaved changes. Continue?";k.useEffect(()=>{const o=n=>{if(i)return n.returnValue=t,t};return window.addEventListener("beforeunload",o),()=>window.removeEventListener("beforeunload",o)},[i])},Bt=()=>{const i=k.useRef(null),t=W(),{error:o,success:n,loading:r}=K(N=>N.saveMeta),{loading:l}=K(N=>N.fetchMeta),{group:d}=K(N=>N.metaState),v=oe(),{id:b}=pe(),[m,h]=kl(),T=b||v,[y,u]=k.useState(!1),[c,x]=k.useState(!1),[j,C]=k.useState(!1),[E,q]=k.useState(Ql(T)),[I,g]=k.useState(0),f=Fl(),p=tt({mode:"onChange"});k.useEffect(()=>{ds(`${s("Manage meta fields")}${c?"*":""}`)},[c]),ht(c),Il(i,()=>{t(lt())});const S=()=>{const N=oe(),D={id:N,name:"meta_box_title",UIName:"meta box title",label:"meta box title",fields:[],isSaved:!1,sort:d.boxes?d.boxes.length:1};t(Je(D)),g(d.boxes?d.boxes.length:0),De(1).then(()=>{ye(`lazy-${N}`)})};k.useEffect(()=>{if(ds(s("Manage meta fields")),Zl("#/meta"),b)t(Ne({id:b})).then(N=>{t(ge(N.payload)),p.setValue("id",b),p.setValue("name",N.payload.name),p.setValue("label",N.payload.label),p.setValue("display",N.payload.display),N.payload.belongs&&N.payload.belongs.map((D,L)=>{p.setValue(`belongs.${L}.id`,D.id),p.setValue(`belongs.${L}.belongsTo`,D.belongsTo),p.setValue(`belongs.${L}.operator`,D.operator),p.setValue(`belongs.${L}.find`,D.find),p.setValue(`belongs.${L}.logic`,D.logic)}),N.payload.boxes&&N.payload.boxes.map((D,L)=>{p.setValue(`boxes.${L}`,D)})}).catch(N=>{console.error(N),C(!0)});else{const N=m.get("find"),D=m.get("belongsTo"),L=`${N?N+"_":""}group_name`,le=`${N?N+" ":""}group name`;let ue={name:L,label:le};if(p.reset(),p.setValue("name",L),p.setValue("label",le),N&&D){const H=oe();p.setValue("belongs.0.id",H),p.setValue("belongs.0.belongsTo",D),p.setValue("belongs.0.operator","="),p.setValue("belongs.0.find",N),ue.belongs=[],ue.belongs.push({id:H,belongsTo:D,operator:"=",find:N})}t(ge(ue))}},[b]);const A=()=>!(y||r||!Q(p.formState.errors)),F=N=>{u(!0),t(st(N)).then(D=>{const L=D.payload;L.success?(b||f("/meta"),p.reset({},{keepValues:!0,keepIsSubmitted:!0}),x(!1),ze.success(s("Meta group settings successfully saved")),t(ge(N)),Ol()):ze.error(L.error),u(!1)}).catch(D=>{ze.error(D),u(!1)})},R=[e.jsx(Y,{type:"button",style:V.SECONDARY,onClick:N=>{N.preventDefault(),S()},children:s("Add meta box")}),e.jsx(Y,{disabled:!A(),style:V.PRIMARY,children:s("Save")}),e.jsx(ut,{})];return b&&l?e.jsx(et,{}):j?e.jsx(ot,{}):e.jsx(O.Fragment,{children:e.jsx(at,{...p,children:e.jsx("form",{onSubmit:p.handleSubmit(F),onChange:()=>{x(!0)},children:e.jsx(Al,{title:s("Manage meta fields"),actions:R,crumbs:[{label:s("Field groups"),link:"/meta"},{label:s("Manage meta fields")}],children:e.jsx("div",{ref:i,children:E==="list"?e.jsx(jl,{view:E,setView:q,boxes:Q(d)?[]:d.boxes}):e.jsx(O.Fragment,{children:E==="accordion"?e.jsx(Tl,{activeBoxTab:I,setActiveBoxTab:g,view:E,setView:q,boxes:Q(d)?[]:d.boxes}):e.jsx(O.Fragment,{children:e.jsx(Nl,{activeBoxTab:I,setActiveBoxTab:g,view:E,setView:q,boxes:Q(d)?[]:d.boxes})})})})})})})})};export{Bt as default};
