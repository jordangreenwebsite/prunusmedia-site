import{j as e,r as U,f as p,u as c,a as ce,s as oe,l as H}from"./fields-GHpMjljq.js";import{a as N,R as w,u as ue}from"./vendor-BmsXziqF.js";import{M as pe,u as he,s as xe,L as me}from"./Layout-6tbtb2_L.js";import{b as B,C as Y,c as T,d as fe,D as ge,e as ve,f as je,g as be,h as ye,M as Ne,a as Ce}from"./sortable.esm-FQQt9Bz4.js";import{P as m,I as y,A as L,s as C,u as k,a as R,R as ke,S as G,T as Re,U as $e,V as we,W as I,X as Ee,Y as Se,Z as $,$ as q,a0 as Te,a1 as K,w as Ve,B as O,a2 as X,n as _,a3 as j,b as W,m as De,a4 as Oe,a5 as P,L as Ae,a6 as Fe,a7 as Ie}from"./index-N_DirKM7.js";import{T as qe,a as M}from"./index-BjKxxx07.js";import{T as Pe}from"./index-CmFkX8j0.js";import{u as z}from"./index-CrI7X7RI.js";import{C as Me}from"./index-D7G017Q_.js";import{d as _e,w as Le}from"./bundle.esm.min-B-HQpnrw.js";import{b as Ge}from"./index.esm-Cy9FKwRd.js";import{M as He}from"./index-BK6Luaau.js";import"./index-BwVKM9Kw.js";const V=({element:a,isDragging:r})=>{const s=a.field,l=a.settings,o=r?{zIndex:1e4,padding:"8px",background:"white",borderRadius:"4px",opacity:"0.8",boxShadow:"rgba(0, 0, 0, 0.16) 0px 1px 4px"}:{},i=()=>{const u=s.extra.options?s.extra.options:[],d=a.id+"-"+U(8);switch(s.type){case p.BUTTON:return e.jsx("button",{id:a.id,type:s.extra.type,className:`acpt-btn acpt-btn-default acpt-btn-primary ${l.css}`,children:s.extra.label},d);case p.CAPTCHA:return e.jsxs("div",{className:"i-flex-center p-8 s-8 bg-pale-gray with-border b-rounded",children:[e.jsx(y,{icon:"logos:recaptcha",width:32}),e.jsx("span",{children:"CAPTCHA"})]});case p.CHECKBOX:return e.jsx("div",{className:"i-flex-center s-8",children:u&&u.map(f=>e.jsxs("div",{className:"i-flex-center s-4",children:[e.jsx("input",{type:"checkbox",checked:f.value===s.extra.defaultValue,value:f.value,id:f.id},d),e.jsx("label",{htmlFor:f.id,children:f.label})]}))});case p.COLOR:return e.jsx("input",{type:"color",className:`form-control ${l.css}`,id:a.id,readOnly:!0,defaultValue:s.extra.defaultValue},d);case p.TIME:return e.jsx("input",{type:"time",className:`form-control ${l.css}`,id:a.id,readOnly:!0,placeholder:s.extra.placeholder,defaultValue:s.extra.defaultValue},d);case p.WORDPRESS_POST_DATE:case p.DATE:case p.DATE_TIME:case p.DATE_RANGE:return e.jsx("input",{type:"date",className:`form-control ${l.css}`,id:a.id,readOnly:!0,placeholder:s.extra.placeholder,defaultValue:s.extra.defaultValue},d);case p.WORDPRESS_USER_EMAIL:case p.EMAIL:return e.jsx("input",{type:"email",className:`form-control ${l.css}`,id:a.id,readOnly:!0,placeholder:s.extra.placeholder,defaultValue:s.extra.defaultValue},d);case p.FILE:return e.jsx("input",{type:"file",className:`form-control ${l.css}`,id:a.id,readOnly:!0,placeholder:s.extra.placeholder,defaultValue:s.extra.defaultValue},d);case p.HIDDEN:return e.jsxs(L,{style:C.DEFAULT,children:["HIDDEN ",s.extra.defaultValue?`[${s.extra.defaultValue}]`:""]});case p.ICON:return e.jsx(y,{icon:"bx:wink-smile",width:24});case p.NUMBER:return e.jsx("input",{type:"number",className:`form-control ${l.css}`,id:a.id,readOnly:!0,min:s.extra.min,max:s.extra.max,step:s.extra.step,placeholder:s.extra.placeholder,defaultValue:s.extra.defaultValue},d);case p.RADIO:return e.jsx("div",{className:"i-flex-center s-8",children:u&&u.map(f=>e.jsxs("div",{className:"i-flex-center s-4",children:[e.jsx("input",{type:"radio",checked:f.value===s.extra.defaultValue,value:f.value,id:f.id},d),e.jsx("label",{htmlFor:f.id,children:f.label})]}))});case p.RANGE:return e.jsx("input",{type:"range",className:`form-control ${l.css}`,id:a.id,readOnly:!0,min:s.extra.min,max:s.extra.max,step:s.extra.step,defaultValue:s.extra.defaultValue,disabled:!0},d);case p.RATING:let t=isNaN(parseInt(s.extra.defaultValue))?0:parseInt(s.extra.defaultValue);t<0&&(t=0),t>5&&(t=5);const v=5-t;return e.jsxs("div",{className:"i-flex-center",children:[[...Array(t)].map((f,n)=>e.jsx(y,{icon:"bxs:star",width:24})),[...Array(v)].map((f,n)=>e.jsx(y,{icon:"bx:star",width:24}))]});case p.WORDPRESS_POST_AUTHOR:case p.SELECT:return e.jsx("select",{className:`form-control ${l.css}`,id:a.id,disabled:!0,multiple:s.extra.isMulti,placeholder:s.extra.placeholder,defaultValue:s.extra.defaultValue,children:u&&u.map(f=>e.jsx("option",{value:f.value,children:f.label}))},d);case p.WORDPRESS_TERM_DESCRIPTION:case p.WORDPRESS_POST_CONTENT:case p.WORDPRESS_POST_EXCERPT:case p.TEXTAREA:return e.jsx("textarea",{className:`form-control ${l.css}`,id:a.id,rows:s.extra.rows,cols:s.extra.cols,readOnly:!0,placeholder:s.extra.placeholder,defaultValue:s.extra.defaultValue},d);case p.TOGGLE:return e.jsx("div",{className:"toggle-group",children:e.jsxs("label",{className:"toggle",children:[e.jsx("input",{readOnly:!0,type:"checkbox",checked:s.extra.checked}),e.jsx("span",{className:"slider round"})]})});case p.CURRENCY:case p.LENGTH:case p.WEIGHT:return e.jsxs("div",{className:"i-flex-center s-8 w-100",children:[e.jsx("input",{type:"text",className:`w-100 form-control ${l.css}`,id:a.id,readOnly:!0,defaultValue:s.extra.defaultValue,disabled:!0},d),e.jsx("span",{children:s.extra.uom})]});case p.WORDPRESS_USER_PASSWORD:return e.jsx("input",{type:"password",className:`form-control ${l.css}`,id:a.id,readOnly:!0,defaultValue:s.extra.defaultValue,disabled:!0},d)}return e.jsx("input",{type:"text",className:`form-control ${l.css}`,id:a.id,readOnly:!0,placeholder:s.extra.placeholder,defaultValue:s.extra.defaultValue},d)};return r?e.jsx("span",{style:o,children:s.name}):e.jsx("div",{className:`text-${l.alignment}`,style:o,children:e.jsxs("div",{className:l.layout==="inline"?"i-flex-center s-8 w-100":"",children:[s.label!==""&&s.label!==null&&e.jsxs("label",{htmlFor:a.id,className:"form-label",style:l.layout==="inline"?{margin:"0"}:null,children:[s.label,a.field.isRequired&&e.jsx("span",{className:"color-danger",children:"*"})]}),e.jsxs("div",{className:"w-100",children:[i(),s.description!==""&&s.description!==null&&e.jsx("div",{className:"form-description color-light-gray",children:s.description})]})]})})};V.propTypes={element:m.object.isRequired,isDragging:m.bool};const Z=({element:a})=>{const r=k(),{activeElement:s}=R(b=>b.formManager),l=a.settings,{setNodeRef:o,isDragging:i,transform:u,listeners:d,attributes:t}=B({id:a.id,data:{fromCanvas:!0}}),v={transform:Y.Translate.toString(u)},f=T({id:a.id+"-top",data:{element:a,isTopHalfElement:!0}}),n=T({id:a.id+"-bottom",data:{element:a,isBottomHalfElement:!0}}),x=T({id:a.id+"-left",data:{element:a,isLeftHalfElement:!0}}),g=T({id:a.id+"-right",data:{element:a,isRightHalfElement:!0}}),h=()=>s?s.id===a.id:!1,E=()=>{r(ke({id:a.id}))},A=()=>{r(G())},S=()=>{r(Re({id:a.id}))},F=()=>{r($e({id:a.id}))};return i?e.jsx("div",{className:`canvas-element col-${l.cols}`,"data-cy":`canvas-element-${a.id}`,children:e.jsx("div",{className:"inside",children:e.jsx("div",{className:"element",children:e.jsx(V,{element:a})})})}):e.jsxs("div",{ref:o,id:a.id,style:v,"data-cy":`canvas-element-${a.id}`,className:`canvas-element col-${l.cols} ${h()?"active":""}`,children:[f.isOver&&e.jsx("div",{className:"top-half-hover-placeholder"}),n.isOver&&e.jsx("div",{className:"bottom-half-hover-placeholder"}),x.isOver&&e.jsx("div",{className:"left-half-hover-placeholder"}),g.isOver&&e.jsx("div",{className:"right-half-hover-placeholder"}),e.jsx("div",{ref:f.setNodeRef,className:"top-half"}),e.jsx("div",{ref:n.setNodeRef,className:"bottom-half"}),e.jsx("div",{ref:x.setNodeRef,className:"left-half"}),e.jsx("div",{ref:g.setNodeRef,className:"right-half"}),e.jsxs("div",{className:`inside ${h()?"active":""}`,children:[h()&&e.jsxs("div",{className:"actions flex s-8",children:[e.jsx("small",{children:a.field.name}),e.jsx("span",{className:"cursor-move handle",...t,...d,children:e.jsx(y,{icon:"bx:move",width:14})}),e.jsx("a",{href:"#",onClick:b=>{b.preventDefault(),b.stopPropagation(),A()},children:e.jsx(y,{icon:"bx:x",width:14})}),e.jsx("a",{href:"#",onClick:b=>{b.preventDefault(),b.stopPropagation(),S()},children:e.jsx(y,{icon:"bx:copy",width:14})}),e.jsx("a",{href:"#",onClick:b=>{b.preventDefault(),b.stopPropagation(),F()},children:e.jsx(y,{icon:"bx:trash",width:14})})]}),e.jsx("div",{onClick:b=>{b.preventDefault(),b.stopPropagation(),E()},className:"element",children:e.jsx(V,{element:a})})]})]})};Z.propTypes={element:m.shape({field:m.object.isRequired,overlayItem:m.element.isRequired,previewItem:m.element.isRequired}).isRequired};const Ke=()=>{const{elements:a}=R(t=>t.formManager),{listeners:r,setNodeRef:s,transform:l,transition:o,isOver:i}=T({id:"canvas-drop-area",data:{isCanvas:!0}}),u={transform:Y.Translate.toString(l),transition:o},d=e.jsx("div",{className:"flex-absolute-center",children:e.jsx("h4",{children:c("Drop elements here")})});return e.jsxs("div",{"data-cy":"form-canvas",ref:s,className:`col-9 canvas with-shadow bg-white b-rounded p-24 ${i?"canvas-hover":""}`,style:u,...r,children:[!i&&a.length===0&&d,e.jsx("div",{className:"canvas-container","data-cy":"form-canvas-container",children:a.map((t,v)=>e.jsx(Z,{element:t},v))})]})},D=({field:a,hidden:r=!1,isDragging:s=!1,mode:l,isActive:o=!0})=>{const i=()=>a.group==="WordPress post fields"?C.INFO:a.group==="WordPress taxonomy fields"?C.WARNING:a.group==="WordPress user fields"?C.DANGER:a.group==="ACPT fields"?C.SECONDARY:C.DEFAULT,u=()=>{const{icon:d}=ce(a.type);return d};return l==="overlay"||l==="dragging"?e.jsx("div",{className:`acpt-badge acpt-badge-${i()} m-0 cursor-move with-shadow`,style:{width:"150px"},children:e.jsxs("span",{className:"flex-between",children:[e.jsx("span",{className:"text-ellipsis",children:a.name}),e.jsx(y,{icon:u(),width:18})]})}):e.jsx("div",{className:`acpt-badge acpt-badge-${i()} m-0 ${r?"hidden":"block"} ${o?"cursor-move":"disabled"} ${s?"with-border":""}`,children:e.jsxs("div",{className:"flex-between",children:[e.jsx("span",{className:"text-ellipsis",children:a.name}),e.jsx(y,{icon:u(),width:18})]})})};D.propTypes={hidden:m.bool,isDragging:m.bool,mode:m.oneOf(["overlay","dragging"]),isActive:m.bool,field:m.shape({id:m.string.isRequired,name:m.string.isRequired,group:m.string.isRequired,type:m.string.isRequired}).isRequired};const J=({field:a,hidden:r})=>{const{elements:s}=R(v=>v.formManager),l={css:"",cols:"12",layout:"block",alignment:"left"},{attributes:o,listeners:i,setNodeRef:u,isDragging:d}=B({id:a.id,data:{field:a,previewItem:e.jsx(V,{element:{field:a}}),settings:l,validationRules:[],fromSidebar:!0}});return(a.isReusable===!0?!0:s.findIndex(v=>v.field.name===a.name)===-1)?e.jsx("div",{"data-cy":`field-panel-element-${a.name}`,className:r?"hidden":"",ref:u,...i,...o,children:e.jsx(D,{field:a,hidden:r,isDragging:d,isActive:!0})}):e.jsx("div",{className:r?"hidden":"",children:e.jsx(D,{field:a,hidden:r,isDragging:d,isActive:!1})})};J.propTypes={hidden:m.bool,field:m.shape({id:m.string.isRequired,name:m.string.isRequired,group:m.string.isRequired,type:m.string.isRequired,extra:m.array.isRequired}).isRequired};const Q=({name:a,fields:r,search:s})=>(()=>{if(!s)return!1;let o=0;return r.map(i=>{s&&H(i.name,s)&&o++}),o===0})()?null:e.jsxs("div",{children:[e.jsx("h4",{className:"mb-12",children:c(a)}),e.jsx("div",{className:"grid grid-2 s-12","data-cy":`field-panel-group-${oe(a)}`,children:r.map(o=>e.jsx(J,{field:o,hidden:s?!H(o.name,s):!1},o.id))})]});Q.propTypes={name:m.string.isRequired,fields:m.array.isRequired,search:m.string};const ee=({fields:a})=>{const[r,s]=N.useState(null),l=()=>{let i=[],u=[];return a.map(d=>{i[d.group]||(i[d.group]=[]),i[d.group].push(d)}),Object.keys(i).map(d=>{u.push({name:d,fields:i[d]})}),u},o=i=>{s(i)};return e.jsxs("div",{className:"flex-column s-24 p-24",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"mb-12",children:c("Form fields")}),e.jsx("input",{type:"text","data-cy":"form-fields-search",className:"form-control",placeholder:c("Search"),onChangeCapture:i=>o(i.target.value)})]}),l().map((i,u)=>e.jsx(Q,{name:i.name,fields:i.fields,search:r},u))]})};ee.propTypes={fields:m.array.isRequired};const ae=({elementId:a,isTextual:r,index:s,rule:l})=>{const o=k(),[i,u]=N.useState(l.condition!=="blank"&&l.condition!=="not_blank"),d=g=>`rules-${a}-${s}-${g}`,t=[{value:"blank",label:"blank"},{value:"not_blank",label:"not blank"},{value:"=",label:"="},{value:"!=",label:"!="},{value:">",label:">"},{value:">=",label:">="},{value:"<",label:"<"},{value:"<=",label:"<="},{value:"max",label:"max"},{value:"min",label:"min"},{value:"regex",label:"regex"}],v=g=>{let h;switch(g){case"blank":h="Value is not blank";break;case"not_blank":h="Value is blank";break;case"=":h="Value is not equal to {{v}}";break;case"!=":h="Value is equal to {{v}}";break;case">":h="Value is lower or equals than {{v}}";break;case">=":h="Value is lower than {{v}}";break;case"<":h="Value is greatest or equals than {{v}}";break;case"<=":h="Value is greatest than {{v}}";break;case"max":h="The maximum length is {{v}}";break;case"min":h="The minimum length is {{v}}";break;case"regex":h="Regex value is not matching {{v}}";break}return c(h)},f=g=>{const h={...l};h.condition=g,h.message=v(g),g==="blank"||g==="not_blank"?(h.value=null,u(!1)):u(!0),o(I({elementId:a,ruleIndex:s,rule:h}))},n=g=>{const h={...l};h.value=g,o(I({elementId:a,ruleIndex:s,rule:h}))},x=g=>{const h={...l};h.message=g,o(I({elementId:a,ruleIndex:s,rule:h}))};return r?e.jsxs("fieldset",{className:"acpt-fieldset",children:[e.jsxs("legend",{children:["Rule #",s+1]}),e.jsx("div",{className:"flex s-8",children:e.jsxs("div",{className:"flex-column s-8",children:[e.jsxs("div",{className:"i-flex-center s-8",children:[e.jsx("div",{className:"w-60",children:e.jsx("select",{className:"form-control",id:d("condition"),defaultValue:l.condition,onChangeCapture:g=>f(g.target.value),children:t.map((g,h)=>e.jsx("option",{value:g.value,children:g.label},h))},d("condition"))}),e.jsx("div",{className:"w-40",children:i?e.jsx("input",{type:"text",id:d("value"),className:"form-control",defaultValue:l.value,onChangeCapture:g=>n(g.target.value)},d("value")):e.jsx("input",{type:"text",readOnly:!0,disabled:!0,placeholder:null,defaultValue:null,id:d("value"),className:"form-control",value:null},d("value"))})]}),e.jsx("input",{type:"text",id:d("message"),className:"form-control",defaultValue:l.message,onChangeCapture:g=>x(g.target.value)},d("message")),e.jsx("a",{href:"#",onClick:g=>{g.preventDefault(),o(we({id:l.id,elementId:a}))},children:c("Delete")})]})})]}):null};ae.propTypes={elementId:m.string.isRequired,isTextual:m.bool.isRequired,index:m.number.isRequired,rule:m.object.isRequired};const se=({element:a})=>{const r=k(),[s]=z();return a.field.validation?e.jsxs("div",{className:"flex-column s-24",children:[e.jsxs("div",{className:"flex-between",children:[e.jsx("label",{className:"form-label",children:c("Field required")}),e.jsx("div",{className:"toggle-group",children:e.jsxs("label",{className:"toggle",children:[e.jsx("input",{id:`required-${a.id}`,name:`required-${a.id}`,type:"checkbox",defaultChecked:a.field.isRequired,onChangeCapture:l=>{r(Ee({id:a.id,value:l.target.checked}))}},`required-${a.id}`),e.jsx("span",{className:"slider round"})]})})]}),a.field.isTextual&&e.jsxs(w.Fragment,{children:[e.jsx("div",{className:"flex-column s-24",ref:s,children:a.validationRules.length>0?e.jsx(w.Fragment,{children:a.validationRules.map((l,o)=>e.jsx(ae,{elementId:a.id,isTextual:a.field.isTextual,rule:l,index:o},l.id))}):e.jsx(L,{style:C.WARNING,children:c('No rules already created. Create the first one now by clicking the button "Add rule"!')})}),e.jsx("a",{href:"#",onClick:l=>{l.preventDefault(),r(Se({id:a.id}))},children:c("Add rule")})]})]}):null};se.propTypes={element:m.object.isRequired};const le=({element:a})=>{const r=k(),[s,l]=N.useState(a.field.name),{register:o,setValue:i}=Ge({mode:"all"});N.useEffect(()=>{i(`name-${a.id}`,s)},[s]);const u=t=>{const v=_e(Le(t));l(v),r(q({id:a.id,key:"name",value:v}))},d=()=>a.field.type!==p.BUTTON&&a.field.type!==p.HIDDEN;return e.jsxs("div",{className:"flex-column s-24",children:[e.jsxs("div",{className:"flex-between",children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:c("Layout")}),e.jsxs("div",{className:"flex s-4",children:[e.jsx("label",{htmlFor:`layout-${a.id}`,className:`acpt-btn-switch ${a.settings.layout==="block"?"active":""}`,onClickCapture:t=>{r($({id:a.id,key:"layout",value:"block"}))},children:e.jsx(y,{icon:"akar-icons:two-line-vertical",width:18})}),e.jsx("label",{htmlFor:`layout-${a.id}`,className:`acpt-btn-switch ${a.settings.layout==="inline"?"active":""}`,onClickCapture:t=>{r($({id:a.id,key:"layout",value:"inline"}))},children:e.jsx(y,{icon:"akar-icons:two-line-horizontal",width:18})})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("label",{className:"form-label",children:c("Alignment")}),e.jsxs("div",{className:"flex s-4",children:[e.jsx("label",{htmlFor:`layout-${a.id}`,className:`acpt-btn-switch ${a.settings.alignment==="left"?"active":""}`,onClickCapture:t=>{r($({id:a.id,key:"alignment",value:"left"}))},children:e.jsx(y,{icon:"bx:align-left",width:18})}),e.jsx("label",{htmlFor:`layout-${a.id}`,className:`acpt-btn-switch ${a.settings.alignment==="center"?"active":""}`,onClickCapture:t=>{r($({id:a.id,key:"alignment",value:"center"}))},children:e.jsx(y,{icon:"bx:align-middle",width:18})}),e.jsx("label",{htmlFor:`layout-${a.id}`,className:`acpt-btn-switch ${a.settings.alignment==="right"?"active":""}`,onClickCapture:t=>{r($({id:a.id,key:"alignment",value:"right"}))},children:e.jsx(y,{icon:"bx:align-right",width:18})})]})]})]}),e.jsxs("div",{className:`name-${a.id}`,children:[e.jsx("label",{className:"form-label",htmlFor:`name-${a.id}`,children:c("Name")}),e.jsx("input",{className:"form-control",name:`name-${a.id}`,id:`name-${a.id}`,defaultValue:a.field.name,disabled:a.field.isReusable===!1,...o(`name-${a.id}`),onChangeCapture:t=>{u(t.target.value)}},`name-${a.id}`)]}),e.jsxs("div",{className:`cols-${a.id}`,children:[e.jsx("label",{className:"form-label",htmlFor:`cols-${a.id}`,children:c("Columns")}),e.jsx("div",{className:"acpt-select",children:e.jsxs("select",{name:`cols-${a.id}`,className:"form-control",id:`cols-${a.id}`,defaultValue:a.settings.cols,onChangeCapture:t=>{r($({id:a.id,key:"cols",value:t.target.value}))},children:[e.jsx("option",{value:"3",children:"3"}),e.jsx("option",{value:"4",children:"4"}),e.jsx("option",{value:"6",children:"6"}),e.jsx("option",{value:"8",children:"8"}),e.jsx("option",{value:"9",children:"9"}),e.jsx("option",{value:"12",children:"12"})]},`cols-${a.id}`)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"ID"}),e.jsx(Me,{text:a.id})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",htmlFor:`css-${a.id}`,children:c("CSS classes")}),e.jsx("input",{className:"form-control",name:"css",id:`css-${a.id}`,defaultValue:a.settings.css,onChangeCapture:t=>{r($({id:a.id,key:"css",value:t.target.value}))}},`css-${a.id}`)]}),d()&&e.jsxs(w.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label",htmlFor:`label-${a.id}`,children:c("Label")}),e.jsx("input",{className:"form-control",name:"label",id:`label-${a.id}`,defaultValue:a.field.label,onChangeCapture:t=>{r(q({id:a.id,key:"label",value:t.target.value}))}},`label-${a.id}`)]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",htmlFor:`description-${a.id}`,children:c("Description")}),e.jsx("textarea",{className:"form-control",name:"description",id:`description-${a.id}`,cols:30,rows:6,defaultValue:a.field.description,onChangeCapture:t=>{r(q({id:a.id,key:"description",value:t.target.value}))}},`description-${a.id}`)]})]})]})};le.propTypes={element:m.object.isRequired};const te=({elementId:a,option:r,optionIndex:s})=>{const l=k(),o=u=>{const d={...r};d.value=u,l(K({elementId:a,optionIndex:s,option:d}))},i=u=>{const d={...r};d.label=u,l(K({elementId:a,optionIndex:s,option:d}))};return e.jsxs("div",{className:"i-flex-center s-8",children:[e.jsx("div",{className:"w-100",children:e.jsx("input",{type:"text",className:"form-control",defaultValue:r.label,onChangeCapture:u=>i(u.target.value)})}),e.jsx("div",{className:"w-100",children:e.jsx("input",{type:"text",className:"form-control",defaultValue:r.value,onChangeCapture:u=>o(u.target.value)})}),e.jsx("a",{href:"#",onClick:u=>{u.preventDefault(),l(Te({id:r.id,elementId:a}))},children:e.jsx(Pe,{icon:!1,tip:c("Delete"),label:e.jsx(y,{icon:"bx-minus"})})})]})};te.propTypes={elementId:m.string.isRequired,optionIndex:m.number.isRequired,option:m.object.isRequired};const ie=({elementId:a})=>{const r=k(),[s,l]=N.useState(!1),[o,i]=N.useState(null),[u,d]=N.useState(null),[t,v]=N.useState(!1);N.useEffect(()=>{t&&(l(!0),Ve("fetchDatasetsAction",{}).then(x=>{let g=[{value:null,label:c("Select"),items:[]}];x.records&&x.records.map(h=>{g.push({value:h.id,label:h.label?h.label:h.name,items:h.items?h.items:[]})}),i(g),l(!1)}).catch(x=>{console.error(x.message),l(!1)}))},[t]);const f=()=>{const x=o.filter(h=>h.value===u);if(x.length!==1)return;const g=x[0].items;console.log(g),g.map(h=>{r(X({elementId:a,label:h.label,value:h.value}))}),_.success(c("Dataset loaded correctly")),v(!t)},n=[e.jsx(O,{style:C.PRIMARY,disabled:u===null,onClick:x=>{x.preventDefault(),f()},children:c("Load dataset")}),e.jsx(O,{style:C.DANGER,onClick:x=>{x.preventDefault(),v(!t)},children:c("Close")})];return e.jsxs(w.Fragment,{children:[e.jsx(pe,{title:c("Load dataset"),visible:t,padding:0,buttons:n,children:s?e.jsx("div",{className:"p-24",children:c("Loading...")}):e.jsx("div",{className:"p-24",children:e.jsx("select",{id:"dataset",className:"form-control default",onChangeCapture:x=>d(x.target.value),children:o&&o.map(x=>e.jsx("option",{value:x.value,children:x.label}))})})}),e.jsx("a",{href:"#",onClick:x=>{x.preventDefault(),v(!t)},children:c("Load dataset")})]})};ie.propTypes={elementId:m.string.isRequired};const re=({elementId:a,options:r})=>{const s=k(),[l]=z();return e.jsxs("div",{children:[e.jsx("label",{className:"form-label",htmlFor:`options-${a}`,children:c("Options")}),e.jsxs("div",{className:"flex-column s-8",ref:l,children:[r&&r.length>0?e.jsx(w.Fragment,{children:r.map((o,i)=>e.jsx(te,{elementId:a,option:o,optionIndex:i},i))}):e.jsx(L,{style:C.WARNING,children:c('No options already created. Create the first one now by clicking the button "Add option"!')}),e.jsxs("div",{className:"mt-24 i-flex-center s-8",children:[e.jsx("a",{href:"#",onClick:o=>{o.preventDefault(),s(X({elementId:a}))},children:c("Add option")}),e.jsx(ie,{elementId:a})]})]})]})};re.propTypes={elementId:m.string.isRequired,options:m.array.isRequired};const ne=({element:a})=>{const s=document.globals.settings,l=k(),o=a.field.type,i=a.field.extra,u=()=>{let t=[];switch(o){case p.FILE:t.push("multiple"),t.push("accept");break;case p.NUMBER:t.push("defaultValue"),t.push("placeholder"),t.push("min"),t.push("max"),t.push("step");break;case p.RANGE:t.push("defaultValue"),t.push("min"),t.push("max"),t.push("step");break;case p.RADIO:case p.SELECT:case p.CHECKBOX:t.push("nullValue"),t.push("defaultValue"),t.push("placeholder"),t.push("options");break;case p.WORDPRESS_POST_CONTENT:case p.WORDPRESS_POST_EXCERPT:case p.TEXTAREA:t.push("defaultValue"),t.push("placeholder"),t.push("wysiwyg"),t.push("rows"),t.push("cols");break;case p.BUTTON:t.push("type"),t.push("label");break;case p.DATE_RANGE:t.push("defaultValue"),t.push("minDate"),t.push("maxDate");break;case p.RATING:case p.HIDDEN:t.push("defaultValue");break;case p.ICON:t.push("defaultValue");break;case p.WORDPRESS_POST_AUTHOR:t.push("nullValue"),t.push("defaultValue"),t.push("placeholder");break;case p.TOGGLE:t.push("checked");break;case p.CURRENCY:case p.LENGTH:case p.WEIGHT:t.push("uom"),t.push("defaultValue"),t.push("placeholder");break;case p.CAPTCHA:t.push("googleSiteKey"),t.push("googleSecretKey");break;default:t.push("defaultValue"),t.push("placeholder");break}return t},d=t=>{switch(t){case"accept":return e.jsxs("div",{children:[e.jsx("label",{className:"form-label",htmlFor:`accept-${a.id}`,children:c("Accept")}),e.jsx("input",{className:"form-control",name:"accept",type:"text",id:`accept-${a.id}`,defaultValue:i.accept,onChangeCapture:n=>{l(j({id:a.id,key:"accept",value:n.target.value}))}},`accept-${a.id}`)]});case"checked":return e.jsxs("div",{className:"flex-between",children:[e.jsx("label",{className:"form-label",children:c("Default value")}),e.jsx("div",{className:"toggle-group",children:e.jsxs("label",{className:"toggle",children:[e.jsx("input",{id:`checked-${a.id}`,name:`checked-${a.id}`,type:"checkbox",defaultChecked:i.checked,onChangeCapture:n=>{l(j({id:a.id,key:"checked",value:n.target.checked}))}},`checked-${a.id}`),e.jsx("span",{className:"slider round"})]})})]});case"cols":return e.jsxs("div",{children:[e.jsx("label",{className:"form-label",htmlFor:`rows-${a.id}`,children:c("Cols value")}),e.jsx("input",{className:"form-control",name:"cols",type:"number",id:`cols-${a.id}`,defaultValue:i.cols,onChangeCapture:n=>{l(j({id:a.id,key:"cols",value:n.target.value}))}},`cols-${a.id}`)]});case"defaultValue":return e.jsxs("div",{children:[e.jsx("label",{className:"form-label",htmlFor:`defaultValue-${a.id}`,children:c("Default value")}),e.jsx("input",{className:"form-control",name:"defaultValue",id:`defaultValue-${a.id}`,defaultValue:i.defaultValue,onChangeCapture:n=>{l(j({id:a.id,key:"defaultValue",value:n.target.value}))}},`defaultValue-${a.id}`)]});case"googleSiteKey":const v=()=>{if(i.googleSiteKey&&i.googleSiteKey!=="")return i.googleSiteKey;const n=W(s,"key","google_recaptcha_site_key");return n?n.value:null};return e.jsxs("div",{children:[e.jsx("label",{className:"form-label",htmlFor:`googleSiteKey-${a.id}`,children:c("Your Google reCAPTCHA site key")}),e.jsx("input",{className:"form-control",name:"googleSiteKey",type:"text",id:`googleSiteKey-${a.id}`,defaultValue:v(),onChangeCapture:n=>{l(j({id:a.id,key:"googleSiteKey",value:n.target.value}))}},`googleSiteKey-${a.id}`)]});case"googleSecretKey":const f=()=>{if(i.googleSecretKey&&i.googleSecretKey!=="")return i.googleSecretKey;const n=W(s,"key","google_recaptcha_secret_key");return n?n.value:null};return e.jsxs("div",{children:[e.jsx("label",{className:"form-label",htmlFor:`googleSecretKey-${a.id}`,children:c("Your Google reCAPTCHA secret key")}),e.jsx("input",{className:"form-control",name:"googleSecretKey",type:"text",id:`googleSecretKey-${a.id}`,defaultValue:f(),onChangeCapture:n=>{l(j({id:a.id,key:"googleSecretKey",value:n.target.value}))}},`googleSecretKey-${a.id}`)]});case"label":return e.jsxs("div",{children:[e.jsx("label",{className:"form-label",htmlFor:`label-${a.id}`,children:c("Label")}),e.jsx("input",{className:"form-control",name:"label",type:"text",id:`label-${a.id}`,defaultValue:i.label,onChangeCapture:n=>{l(j({id:a.id,key:"label",value:n.target.value}))}},`label-${a.id}`)]});case"max":return e.jsxs("div",{children:[e.jsx("label",{className:"form-label",htmlFor:`min-${a.id}`,children:c("Maximum value")}),e.jsx("input",{className:"form-control",name:"max",type:"number",id:`max-${a.id}`,defaultValue:i.max,onChangeCapture:n=>{l(j({id:a.id,key:"max",value:n.target.value}))}},`max-${a.id}`)]});case"maxDate":return e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:c("Maximum date")}),e.jsx("input",{className:"form-control",name:"maxDate",type:"date",id:`maxDate-${a.id}`,defaultValue:i.maxDate,onChangeCapture:n=>{l(j({id:a.id,key:"maxDate",value:n.target.value}))}},`maxDate-${a.id}`)]});case"min":return e.jsxs("div",{children:[e.jsx("label",{className:"form-label",htmlFor:`min-${a.id}`,children:c("Minimum value")}),e.jsx("input",{className:"form-control",name:"min",type:"number",id:`min-${a.id}`,defaultValue:i.min,onChangeCapture:n=>{l(j({id:a.id,key:"min",value:n.target.value}))}},`min-${a.id}`)]});case"minDate":return e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:c("Minimum date")}),e.jsx("input",{className:"form-control",name:"minDate",type:"date",id:`minDate-${a.id}`,defaultValue:i.minDate,onChangeCapture:n=>{l(j({id:a.id,key:"minDate",value:n.target.value}))}},`minDate-${a.id}`)]});case"multiple":return e.jsxs("div",{className:"flex-between",children:[e.jsx("label",{className:"form-label",children:c("Multiple")}),e.jsx("div",{className:"toggle-group",children:e.jsxs("label",{className:"toggle",children:[e.jsx("input",{id:`multiple-${a.id}`,name:`multiple-${a.id}`,type:"checkbox",defaultChecked:i.multiple,onChangeCapture:n=>{l(j({id:a.id,key:"multiple",value:n.target.checked}))}},`multiple-${a.id}`),e.jsx("span",{className:"slider round"})]})})]});case"nullValue":return e.jsxs("div",{className:"flex-between",children:[e.jsx("label",{className:"form-label",children:c("Allow empty value")}),e.jsx("div",{className:"toggle-group",children:e.jsxs("label",{className:"toggle",children:[e.jsx("input",{id:`empty-${a.id}`,name:`empty-${a.id}`,type:"checkbox",defaultChecked:i.empty,onChangeCapture:n=>{l(j({id:a.id,key:"empty",value:n.target.checked}))}},`empty-${a.id}`),e.jsx("span",{className:"slider round"})]})})]});case"options":return e.jsx(re,{elementId:a.id,options:i.options});case"placeholder":return e.jsxs("div",{children:[e.jsx("label",{className:"form-label",htmlFor:`placeholder-${a.id}`,children:c("Placeholder")}),e.jsx("input",{className:"form-control",name:"placeholder",id:`placeholder-${a.id}`,defaultValue:i.placeholder,onChangeCapture:n=>{l(j({id:a.id,key:"placeholder",value:n.target.value}))}},`placeholder-${a.id}`)]});case"rows":return e.jsxs("div",{children:[e.jsx("label",{className:"form-label",htmlFor:`rows-${a.id}`,children:c("Rows value")}),e.jsx("input",{className:"form-control",name:"rows",type:"number",id:`rows-${a.id}`,defaultValue:i.rows,onChangeCapture:n=>{l(j({id:a.id,key:"rows",value:n.target.value}))}},`rows-${a.id}`)]});case"step":return e.jsxs("div",{children:[e.jsx("label",{className:"form-label",htmlFor:`step-${a.id}`,children:c("Step value")}),e.jsx("input",{className:"form-control",name:"step",type:"number",id:`step-${a.id}`,defaultValue:i.step,onChangeCapture:n=>{l(j({id:a.id,key:"step",value:n.target.value}))}},`step-${a.id}`)]});case"type":return e.jsxs("div",{children:[e.jsx("label",{className:"form-label",htmlFor:`type-${a.id}`,children:c("Type value")}),e.jsxs("select",{className:"form-control",name:"type",defaultValue:i.type,onChangeCapture:n=>{l(j({id:a.id,key:"type",value:n.target.value}))},children:[e.jsx("option",{value:"submit",children:"submit"}),e.jsx("option",{value:"reset",children:"reset"}),e.jsx("option",{value:"button",children:"button"})]})]});case"uom":return e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:c("UOM default value")}),e.jsx("input",{className:"form-control",name:"uom",type:"text",id:`uom-${a.id}`,defaultValue:i.uom,onChangeCapture:n=>{l(j({id:a.id,key:"uom",value:n.target.value}))}},`uom-${a.id}`)]});case"wysiwyg":return e.jsxs("div",{className:"flex-between",children:[e.jsx("label",{className:"form-label",children:c("Enable editor")}),e.jsx("div",{className:"toggle-group",children:e.jsxs("label",{className:"toggle",children:[e.jsx("input",{id:`wysiwyg-${a.id}`,name:`wysiwyg-${a.id}`,type:"checkbox",defaultChecked:i.wysiwyg,onChangeCapture:n=>{l(j({id:a.id,key:"wysiwyg",value:n.target.checked}))}},`wysiwyg-${a.id}`),e.jsx("span",{className:"slider round"})]})})]})}return null};return e.jsx("div",{className:"flex-column s-24",children:u().map(t=>d(t))})};ne.propTypes={element:m.object.isRequired};const We=()=>{const a=k(),{activeElement:r,elements:s}=R(i=>i.formManager),l=r.id,o=()=>{const i=s.filter(u=>u.id===l);return i.length===1?i[0]:null};return o()?e.jsxs(w.Fragment,{children:[e.jsxs("div",{className:"p-24 flex-between b-bottom-1",children:[e.jsxs("span",{className:"i-flex-center s-8",children:[e.jsx("span",{className:"color-black text-ellipsis",children:o().field.name}),e.jsx(He,{fieldType:o().field.type})]}),e.jsx("a",{href:"#",onClick:i=>{i.preventDefault(),a(G())},children:e.jsx(y,{icon:"bx:x",width:24,color:"#1d2327"})})]}),e.jsx("div",{className:"p-24",children:e.jsxs(qe,{children:[e.jsx(M,{title:c("Settings"),children:e.jsx(le,{element:o()})}),e.jsx(M,{title:c("Extra"),children:e.jsx(ne,{element:o()})}),o().field.validation&&e.jsx(M,{title:c("Validation"),children:e.jsx(se,{element:o()})})]})})]}):null},de=({fields:a})=>{const{activeElement:r}=R(s=>s.formManager);return e.jsx("div",{className:"col-3",children:e.jsx("div",{className:"with-shadow bg-white b-rounded",children:r?e.jsx(We,{}):e.jsx(ee,{fields:a})})})};de.propTypes={fields:m.array.isRequired};const Ue=()=>{const{elements:a}=R(u=>u.formManager),[r,s]=N.useState(null);if(fe({onDragStart:u=>{s(u.active)},onDragCancel:u=>{s(null)},onDragEnd:u=>{s(null)}}),!r)return null;let l=e.jsx("div",{children:"No drag overlay"});const o=r.data.current.fromSidebar,i=r.data.current.fromCanvas;if(o&&(l=e.jsx(D,{field:r.data.current.field,mode:"overlay"})),i){const u=a.filter(d=>d.id===r.id);u.length===1&&(l=e.jsx(D,{field:u[0].field,mode:"dragging"}))}return e.jsx(ge,{children:l})},ra=()=>{const{id:a}=ue(),r=k(),{elements:s}=R(v=>v.formManager),{data:l}=R(v=>v.fetchFormFields),o=N.useRef(null);he(o,()=>{document.getElementsByClassName("acpt-overlay").length>0||r(G())}),N.useEffect(()=>{xe(),De(c("Form manager")),r(Oe(a)).then(v=>{const f=v.payload.saved;let n=[];typeof f=="object"&&f.length>0&&f.map(x=>{const g={id:x.id,metaFieldId:x.metaFieldId,group:x.group,name:x.name,label:x.label,description:x.description,type:x.type,isRequired:x.isRequired,validation:x.validation,isTextual:x.isTextual,extra:x.extra},h={id:x.key,field:g,previewItem:e.jsx(V,{element:{field:g}}),settings:x.settings,validationRules:x.validationRules,fromSidebar:!0};n.push(h)}),r(P({elements:n}))})},[a]);const i=ve(je(Ne)),u=v=>{const{active:f,over:n}=v;if(!f||!n)return;const x=f.data.current.fromSidebar,g=f.data.current.fromCanvas;if(x){const h=n.id,E=U(8);r(Fe({element:{id:E,...f.data.current},position:h}))}if(g){const h=n.id.split("-");let E=h[0];const A=s.findIndex(b=>b.id===f.id);let S=s.findIndex(b=>b.id===E);(h[1]==="bottom"||h[1]==="right")&&(S=S+1);const F=Ce(s,A,S);r(P({elements:F}))}},d=()=>{r(Ie({id:a,data:s})).then(v=>{const f=v.payload;f.success?_.success(c("Form successfully saved")):_.error(f.error)})};if(!l.fields)return e.jsx(Ae,{});const t=[e.jsx(O,{testId:"save-form",style:C.PRIMARY,onClick:()=>{d()},children:c("Save")}),e.jsx(O,{style:C.DANGER,onClick:()=>{r(P({elements:[]}))},children:c("Reset fields")})];return e.jsx(me,{actions:t,title:c("Form manager"),crumbs:[{label:c("Forms list"),link:"/forms"},{label:c("Form manager")}],children:e.jsxs(be,{onDragEnd:u,collisionDetection:ye,sensors:i,autoScroll:!0,children:[e.jsxs("div",{className:"container",ref:o,children:[e.jsx(de,{fields:l.fields}),e.jsx(Ke,{})]}),e.jsx(Ue,{})]})})};export{ra as default};
